openapi: "3.0.0"
info:
  title: "KSA Payment API"
  description: "## KSA Open Banking Payment API Specification"
  version: "2023.11.01-final"
servers:
  - url: "/open-banking/payment/2023.11.01-final"
tags:
  - name: Payment Initiation
    description: Initiate a Payment Consent
  - name: Payment Instruction
    description: Instruct the Payment
  - name: Refund Initiation
    description: Initiate a Refund Consent
  - name: Refund Instruction
    description: Instruct the Refund
  - name: Request To Pay Initiation
    description: Initiate a Request To Pay Consent
  - name: Request To Pay Instruction
    description: Instruct a Requests To Pay
paths:
  /payment-consents:
    post:
      tags:
        - "Payment Initiation"
      summary: "Initiate Payment Consent"
      description: |
        Initiate a Payment Consent               
      operationId: "InitiatePaymentConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key-consent"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticPaymentConsentRequestSigned"
        required: true
      callbacks: 
        PASP-Event:
           '{$request.body#/Subscription/Webhook/Url}':
            post:
              description: |
                **This is a generic Webhook definition and SHOULD apply to any Event that is published by the PASP**
              parameters:
                - $ref: "#/components/parameters/authorization"
                - $ref: "#/components/parameters/x-fapi-interaction-id-request"
              requestBody:
                required: true
                content:
                  application/jwt:
                    schema:
                      $ref: "#/components/schemas/OBWebhookEventSigned"        
              responses:
                '202':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '400':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '401':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '403':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '500':
                  $ref: "#/components/responses/PISPWebhookResponse"
              security:
                - PASPWebhookSecurity: []
      responses:
        '201':
          $ref: "#/components/responses/201DomesticPaymentConsentCreated"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "payments"           
    get:
      tags:
        - "Payment Initiation"
      summary: "Retrieve Payment Consents by BaseConsentId"
      description: |
        Retrieve all Payment Consents for an BaseConsentId                
      operationId: "RetrievePaymentConsentsByBaseConsentId"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/baseConsentId"        
      responses:
        '200':
          $ref: "#/components/responses/200BaseConsentIdConsentsRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "payments"            
  /payment-consents/{ConsentId}: 
    get:
      tags:
        - "Payment Initiation"
      summary: "Retrieve a Payment Consent"
      description: |
        Retrieve a Payment Consent               
      operationId: "RetrievePaymentConsent"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/ConsentId"
      responses:
        '200':
          $ref: "#/components/responses/200DomesticPaymentConsentRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "payments"            
    patch:
      tags:
        - "Payment Initiation"
      summary: "Modify a Payment Consent"
      description: |
        Modify a Payment Consent
      operationId: "PatchPaymentConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/ConsentId"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
      requestBody:
        description: |
          Request Body               
        content:        
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBPatchPaymentConsentSigned"
      responses:
        '204':
          $ref: "#/components/responses/204NoContent"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security:
            - "openid"
            - "payments"
  /payments: 
    post:
      tags:
        - "Payment Instruction"
      summary: "Create a Payment"
      description: |
        Create a Payment               
      operationId: "CreatePayment"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticPaymentRequestSigned"
      responses:
        '201':
          $ref: "#/components/responses/201PaymentId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PSUOAuth2Security: 
            - "openid"
            - "payments"                          
    head:
      tags:
        - "Payment Instruction"
      summary: "Query for a PaymentId"
      description: |
        Lookup the Payments Resource (PaymentId) using the x-idempotency-key. 
        The Location response Header must return the full Url of the Payment resource associated with the x-idempotency-key.
        This is an alternative way for PISPs to obtain a PaymentId where they did not receive any response body from the PASP (due to network error or timeout).                
      operationId: "QueryPaymentResource"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      responses:
        '204':
          $ref: "#/components/responses/204NoContentHead"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "payments"                              
  /payments/{PaymentId}:
    get:
      tags:
        - "Payment Instruction"
      summary: "Retrieve a Payment"
      description: |
        Retrieve a Payment               
      operationId: "RetrievePayment"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/PaymentId"
      responses:
        '200':
          $ref: "#/components/responses/200PaymentId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "payments"
  /refund-consents:
    post:
      tags:
        - "Refund Initiation"
      summary: "Initiate Refund Consent"
      description: |
        Initiate a Refund Consent               
      operationId: "InitiateRefundConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key-consent"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticRefundConsentRequestSigned"
        required: true
      callbacks: 
        PASP-Event:
           '{$request.body#/Subscription/Webhook/Url}':
            post:
              description: |
                **This is a generic Webhook definition and SHOULD apply to any Event that is published by the PASP**
              parameters:
                - $ref: "#/components/parameters/authorization"
                - $ref: "#/components/parameters/x-fapi-interaction-id-request"
              requestBody:
                required: true
                content:
                  application/jwt:
                    schema:
                      $ref: "#/components/schemas/OBWebhookEventSigned"        
              responses:
                '202':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '400':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '401':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '403':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '500':
                  $ref: "#/components/responses/PISPWebhookResponse"
              security:
                - PASPWebhookSecurity: []
      responses:
        '201':
          $ref: "#/components/responses/201DomesticRefundConsentCreated"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "refunds"            
    get:
      tags:
        - "Refund Initiation"
      summary: "Retrieve Refund Consents by BaseConsentId"
      description: |
        Retrieve all Refund Consents for an BaseConsentId                
      operationId: "RetrieveRefundConsentsByBaseConsentId"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/baseConsentId"        
      responses:
        '200':
          $ref: "#/components/responses/200BaseConsentIdRefundConsentsRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "refunds"                        
  /refund-consents/{ConsentId}: 
    get:
      tags:
        - "Refund Initiation"
      summary: "Retrieve a Refund Consent"
      description: |
        Retrieve a Refund Consent               
      operationId: "RetrieveRefundConsent"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/ConsentId"
      responses:
        '200':
          $ref: "#/components/responses/200DomesticRefundConsentRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "refunds"            
    patch:
      tags:
        - "Refund Initiation"
      summary: "Modify a Refund Consent"
      description: |
        Modify a Refund Consent
      operationId: "PatchRefundConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/ConsentId"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
      requestBody:
        description: |
          Request Body               
        content:        
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBPatchRefundConsentSigned"
      responses:
        '204':
          $ref: "#/components/responses/204NoContent"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security:
            - "openid"
            - "refunds"
  /refunds: 
    post:
      tags:
        - "Refund Instruction"
      summary: "Create Refunds"
      description: |
        Create Refunds for a Long Lived Consent               
      operationId: "CreateRefund"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticRefundRequestSigned"
      responses:
        '201':
          $ref: "#/components/responses/201RefundId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PSUOAuth2Security: 
            - "openid"
            - "refunds"          
    head:
      tags:
        - "Refund Instruction"
      summary: "Query for a RefundsId"
      description: |
        Lookup the Refunds Resource (RefundsId) using the x-idempotency-key. 
        The Location response Header must return the full Url of the Refunds resource associated with the x-idempotency-key.
        This is an alternative way for PISPs to obtain a RefundsId where they did not receive any response body from the PASP (due to network error or timeout).                
      operationId: "QueryRefundsResource"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      responses:
        '204':
          $ref: "#/components/responses/204NoContentHead"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "refunds"                              
  /refunds/{RefundsId}:
    get:
      tags:
        - "Refund Instruction"
      summary: "Retrieve Refunds"
      description: |
        Retrieve a Refund               
      operationId: "RetrieveRefund"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/RefundsId"
        - $ref: "#/components/parameters/paymentTransactionId"        
      responses:
        '200':
          $ref: "#/components/responses/200RefundId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "refunds"                              
  /request-to-pay-consents:
    post:
      tags:
        - "Request To Pay Initiation"
      summary: "Initiate Request To Pay Consent"
      description: |
        Initiate a Request To Pay Consent               
      operationId: "InitiateRequestToPayConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key-consent"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticRequestToPayConsentRequestSigned"
        required: true
      callbacks: 
        PASP-Event:
           '{$request.body#/Subscription/Webhook/Url}':
            post:
              description: |
                **This is a generic Webhook definition and SHOULD apply to any Event that is published by the PASP**
              parameters:
                - $ref: "#/components/parameters/authorization"
                - $ref: "#/components/parameters/x-fapi-interaction-id-request"
              requestBody:
                required: true
                content:
                  application/jwt:
                    schema:
                      $ref: "#/components/schemas/OBWebhookEventSigned"        
              responses:
                '202':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '400':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '401':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '403':
                  $ref: "#/components/responses/PISPWebhookResponse"
                '500':
                  $ref: "#/components/responses/PISPWebhookResponse"
              security:
                - PASPWebhookSecurity: []
      responses:
        '201':
          $ref: "#/components/responses/201DomesticRequestToPayConsentCreated"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"            
    get:
      tags:
        - "Request To Pay Initiation"
      summary: "Retrieve Request To Pay Consents by BaseConsentId"
      description: |
        Retrieve all Request To Pay Consents for an BaseConsentId                
      operationId: "RetrieveRequesToPayConsentsByBaseConsentId"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/baseConsentId"        
      responses:
        '200':
          $ref: "#/components/responses/200BaseConsentIdRequestToPayConsentsRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"                        
  /request-to-pay-consents/{ConsentId}: 
    get:
      tags:
        - "Request To Pay Initiation"
      summary: "Retrieve a Request To Pay Consent"
      description: |
        Retrieve a Request To Pay Consent               
      operationId: "RetrieveRequestToPayConsent"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/ConsentId"
      responses:
        '200':
          $ref: "#/components/responses/200DomesticRequestToPayConsentRetrieve"
        '400':
          $ref: "#/components/responses/400Error"     
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"
    patch:
      tags:
        - "Request To Pay Initiation"
      summary: "Modify a Request To Pay Consent"
      description: |
        Modify a Request To Pay Consent
      operationId: "PatchRequestToPayConsent"
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/ConsentId"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/Prefer"        
      requestBody:
        description: |
          Request Body               
        content:        
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBPatchRTPConsentSigned"
      responses:
        '204':
          $ref: "#/components/responses/204NoContentConsent"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security:
            - "openid"
            - "requeststopay"
  /requests-to-pay: 
    post:
      tags:
        - "Request To Pay Instruction"
      summary: "Create Requests To Pay"
      description: |
        Create Requests To Pay for a Long Lived Consent             
      operationId: "CreateRequestToPay"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBDomesticRequestToPayRequestSigned"
      responses:
        '201':
          $ref: "#/components/responses/201RequestToPayId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PSUOAuth2Security: 
            - "openid"
            - "requeststopay"   
    head:
      tags:
        - "Request To Pay Instruction"
      summary: "Query for a RequestsToPayId"
      description: |
        Lookup the Requests To Pay Resource (RequestsToPayId) using the x-idempotency-key. 
        The Location response Header must return the full Url of the Requests To Pay resource associated with the x-idempotency-key.
        This is an alternative way for PISPs to obtain a RequestsToPayId where they did not receive any response body from the PASP (due to network error or timeout).                
      operationId: "QueryRequestsToPayIdResource"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/x-idempotency-key"
      responses:
        '204':
          $ref: "#/components/responses/204NoContentHead"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"                              
  /requests-to-pay/{RequestsToPayId}:
    get:
      tags:
        - "Request To Pay Instruction"
      summary: "Retrieve Requests To Pay"
      description: |
        Retrieve Requests To Pay               
      operationId: "RetrieveRequestToPay"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/RequestsToPayId"
        - $ref: "#/components/parameters/requestToPayTransactionId"        
      responses:
        '200':
          $ref: "#/components/responses/200RequestToPayId"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '404':
          $ref: "#/components/responses/404Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"             
    patch:
      tags:
        - "Request To Pay Instruction"
      summary: "Modify Requests To Pay"
      description: |
        Modify Requests To Pay             
      operationId: "ModifyRequestToPay"   
      parameters:
        - $ref: "#/components/parameters/authorization"
        - $ref: "#/components/parameters/x-fapi-auth-date"
        - $ref: "#/components/parameters/x-fapi-customer-ip-address"
        - $ref: "#/components/parameters/x-fapi-interaction-id-request"
        - $ref: "#/components/parameters/x-customer-user-agent"
        - $ref: "#/components/parameters/RequestsToPayId"
      requestBody:
        description: |
          Request Body               
        content:
          application/jwt:
            schema:
              $ref: "#/components/schemas/OBPatchRequestsToPaySigned"
      responses:
        '204':
          $ref: "#/components/responses/204NoContent"
        '400':
          $ref: "#/components/responses/400Error"
        '401':
          $ref: "#/components/responses/401Error"
        '403':
          $ref: "#/components/responses/403Error"
        '405':
          $ref: "#/components/responses/405Error"
        '406':
          $ref: "#/components/responses/406Error"
        '415':
          $ref: "#/components/responses/415Error"
        '429':
          $ref: "#/components/responses/429Error"
        '500':
          $ref: "#/components/responses/500Error"
      security:
        - PISPOAuth2Security: 
            - "openid"
            - "requeststopay"                              
components:
  ############################################
  # RESPONSES
  ############################################
  responses:
    PISPWebhookResponse:
      description: "Response Status Code"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    403Error:
      description: "Forbidden"
      headers:
       x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBErrorResponseSigned"
          examples:
            Forbidden:
              $ref: "#/components/examples/Error403ForbiddenSigned"
    404Error:
      description: "Not found"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    405Error:
      description: "Method Not Allowed"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    406Error:
      description: "Not Acceptable"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    415Error:
      description: "Unsupported Media Type"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    429Error:
      description: "Too Many Requests"
      headers:
        Retry-After:
          description: "Number in seconds to wait"
          schema:
            type: "integer"
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    500Error:
      description: "Internal Server Error"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBErrorResponseSigned"
          examples:
            Internal Server Error:
              $ref: "#/components/examples/Error500InternalServerErrorSigned"
    401Error:
      description: "Unauthorized"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
    400Error:
      description: "Bad request"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"      
      content:        
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBErrorResponseSigned"
          examples:
            Bad Request:
              $ref: "#/components/examples/Error400BadRequestSigned" 
    201DomesticPaymentConsentCreated:
      description: "Domestic Payments Consent Created"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticPaymentConsentResponseSigned"      
    200DomesticPaymentConsentRetrieve:
      description: "Domestic Payments Retrieve"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticPaymentConsentResponseSigned"        
    200BaseConsentIdConsentsRetrieve:
      description: "Retrieve Payment Consents by BaseConsentId"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBPaymentConsentsByBaseConsentIdResponseSigned"        
    200BaseConsentIdRefundConsentsRetrieve:
      description: "Retrieve Refund Consents by BaseConsentId"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBRefundConsentsByBaseConsentIdResponseSigned"        
    200BaseConsentIdRequestToPayConsentsRetrieve:
      description: "Retrieve Request to Pay Consents by BaseConsentId"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBRequestToPayConsentsByBaseConsentIdResponseSigned"        
    201PaymentId:
      description: "Domestic Payment Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticPaymentIdResponseSigned"
    200PaymentId:
      description: "Domestic Payment Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticPaymentIdResponseSigned"
    204NoContent:
      description: "No Content"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
    204NoContentHead:
      description: "No Content"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
        Location:
          $ref: "#/components/parameters/Location"
    201DomesticRefundConsentCreated:
      description: "Domestic Refunds Consent Created"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRefundConsentResponseSigned"              
    200DomesticRefundConsentRetrieve:
      description: "Domestic Refunds Retrieve"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRefundConsentResponseSigned"              
    201RefundId:
      description: "Domestic Refund Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRefundIdResponseSigned"
    200RefundId:
      description: "Domestic Refund Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRefundIdResponseSigned"
    201DomesticRequestToPayConsentCreated:
      description: "Domestic Request To Pay Consent Created"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRequestToPayConsentResponseSigned"              
    200DomesticRequestToPayConsentRetrieve:
      description: "Domestic Request To Pay Retrieve"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"          
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRequestToPayConsentResponseSigned"              
    204NoContentConsent:
      description: "No Content"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"        
        Preference-Applied:
          $ref: "#/components/parameters/Preference-Applied"
    201RequestToPayId:
      description: "Domestic Request To Pay Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
        x-idempotency-key:
          $ref: "#/components/parameters/x-idempotency-key-consent"
        Location:
          $ref: "#/components/parameters/Location"
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRequestToPayIdResponseSigned"
    200RequestToPayId:
      description: "Domestic Request To Pay Id"
      headers:
        x-fapi-interaction-id:
          $ref: "#/components/parameters/x-fapi-interaction-id-response"     
      content:
        application/jwt:
          schema:
            $ref: "#/components/schemas/OBDomesticRequestToPayIdResponseSigned"
  ############################################
  # SCHEMAS
  ############################################
  schemas:
    OBJwt:
        title: "OBJwt"
        description: |
          [https://www.rfc-editor.org/rfc/rfc7519](https://www.rfc-editor.org/rfc/rfc7519)
        type: "object"
        properties:
          iss:
            description: |
              [https://www.rfc-editor.org/rfc/rfc7519#section-4.1.1](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.1)          
            type: string
          exp:
            description: |
              [https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4)          
            type: number
          nbf:
            description: |
              [https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.5)          
            type: number
          aud:
            description: |
              [https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3)          
            type: array
            items:
              type: string
          iat:
            description: |
              [https://www.rfc-editor.org/rfc/rfc7519#section-4.1.6](https://www.rfc-editor.org/rfc/rfc7519#section-4.1.6)          
            type: number
        required: [ iss, exp, nbf ]             
    OBDomesticPaymentConsentRequestSigned:
      title: "OBDomesticPaymentConsentRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPaymentConsentRequest'
          required: [message]               
    OBDomesticPaymentConsentResponseSigned:
      title: "OBDomesticPaymentConsentResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPaymentConsentResponse'
          required: [message]               
    OBPaymentConsentsByBaseConsentIdResponseSigned:
      title: "OBPaymentConsentsByBaseConsentIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              type: "array"
              items:
                $ref: '#/components/schemas/OBPaymentConsentResponse'
          required: [message]               
    OBRefundConsentsByBaseConsentIdResponseSigned:
      title: "OBRefundConsentsByBaseConsentIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              type: "array"
              items:
                $ref: '#/components/schemas/OBRefundConsentResponse'
          required: [message]               
    OBRequestToPayConsentsByBaseConsentIdResponseSigned:
      title: "OBRefundConsentsByBaseConsentIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              type: "array"
              items:
                $ref: '#/components/schemas/OBRequestToPayConsentResponse'
          required: [message]               
    OBDomesticPaymentIdResponseSigned:
      title: "OBDomesticPaymentIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPaymentIdResponse'
          required: [message]               
    OBDomesticPaymentRequestSigned:
      title: "OBDomesticPaymentRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPaymentRequest'
          required: [message]               
    OBErrorResponseSigned:
      title: "OBErrorResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBErrorResponse'
          required: [message]               
    OBWebhookEventSigned:
      title: "OBWebhookEventSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBWebhookEvent'
          required: [message]                   
    OBDomesticRefundConsentRequestSigned:
      title: "OBDomesticRefundConsentRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRefundConsentRequest'
          required: [message]     
    OBDomesticRefundRequestSigned:
      title: "OBDomesticRefundRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRefundRequest'
          required: [message]               
    OBDomesticRefundIdResponseSigned:
      title: "OBDomesticRefundIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRefundIdResponse'
          required: [message]               
    OBDomesticRequestToPayConsentRequestSigned:
      title: "OBDomesticRequestToPayConsentRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRequestToPayConsentRequest'
          required: [message]               
    OBDomesticRequestToPayConsentResponseSigned:
      title: "OBDomesticRequestToPayConsentResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRequestToPayConsentResponse'
          required: [message]               
    OBDomesticRequestToPayRequestSigned:
      title: "OBDomesticRequestToPayRequestSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRequestToPayRequest'
          required: [message]               
    OBDomesticRequestToPayIdResponseSigned:
      title: "OBDomesticRequestToPayIdResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRequestToPayIdResponse'
          required: [message]               
    OBRequestToPayIdResponse:
      title: "OBRequestToPayIdResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "RequestsToPayId"
            - "ConsentId"
            - "Type"
            - "Instruction"
          properties:
            RequestsToPayId:
              $ref: "#/components/schemas/OBRequestToPayId"
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type:
              $ref: "#/components/schemas/OBRequestToPayTypeResponse" 
            Instruction:
              $ref: "#/components/schemas/OBRequestToPayInitiationInstructionResponse"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Links:
          $ref: "#/components/schemas/OBPaginationLinks"    
        Meta:
          $ref: "#/components/schemas/OBMetaTotalPages"         
    OBRequestToPayId:
      title: "OBRequestToPayId"
      description: "An API specific unique identification as assigned by the PASP to identify the domestic Request To Pay resource."
      type: "string"
      minLength: 1
      maxLength: 40
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    OBRequestToPayInitiationInstructionResponse:
      title: "OBRequestToPayInitiationInstructionResponse"
      description: |
        (Array) of Single or Multiple Request To Pay Instructions

        * Please refer to the Business Rules, PIS Limits and Constants, Maximum RTPs per Message for the limit.
      type: "array"
      minItems: 1
      maxItems: 10
      items: 
        allOf:
          - type: "object"
            required:
              - "RequestToPayStatus"
              - "RequestToPayStatusUpdateDateTime"
              - "CreationDateTime"
              - "Amount"
              - "RequestToPayPurposeCode"
              - "RequestToPayTransactionId"
              - "DebtorAccount"
            properties:                  
              RequestToPayTransactionId:
                $ref: "#/components/schemas/OBRequestToPayTransactionId"
              Amount:
                $ref: "#/components/schemas/OBActiveCurrencyAmount" 
              RequestToPayStatus:
                $ref: "#/components/schemas/OBRequestToPayStatus"
              RequestToPayStatusUpdateDateTime:
                $ref: "#/components/schemas/OBStatusUpdateDateTime"
              RequestToPayStatusDetail:
                $ref: "#/components/schemas/OBRequestToPayStatusDetail"      
              IsPendingCancellation:
                  $ref: "#/components/schemas/OBPendingCancellation"
              CreationDateTime:
                  $ref: "#/components/schemas/OBCreationDateTime"
              Charges:
                  $ref: "#/components/schemas/OBCharges"
              DebtorAgent:
                $ref: "#/components/schemas/OBCreditorAgent"
              DebtorAccount:
                  $ref: "#/components/schemas/OBDebtorAccount"
              RequestToPayPurposeCode:
                $ref: "#/components/schemas/OBPaymentPurposeCode"      
              NoteToPayer:
                $ref: "#/components/schemas/OBRTPPayerNote"     
              RequestToPayExpiryWindow:
                $ref: "#/components/schemas/OBRTPExpiryWindow"    
            additionalProperties: false
    OBPatchRequestsToPaySigned: 
      title: "OBPatchRequestsToPayIdSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPatchRequestsToPayIdSigned'
          required: [message]              
    OBEventNotification:
      title: "OBEventNotification"
      type: "object"      
      description: |
        A Webhook Subscription Schema
      required:
        - "Webhook"
      properties:
        Webhook:
          description: |
            A Webhook Schema
          type: "object"
          properties:
            Url: 
              description: |
                The PISP Callback URL being registered with the PASP 
              type: "string"
              example: "https://api.pisp.com/webhook/callbackUrl"
            IsActive:
              description: |
                The PISP specifying whether the PASP should send (IsActive true) or not send (IsActive false) Webhook Notifications to the PISP's Webhook URL 
              type: "boolean"
              example: false
          additionalProperties: false
      additionalProperties: false
    OBWebhookEvent:
      title: "OBWebhookEvent"
      type: "object"
      description: "Webhook Event"
      required:
      - "Data"
      - "EventMeta"
      properties:
        Data:
          type: "object"
          description: "Event Data. This Data Object will contain the same API resource and Schema that has triggered the Event."
        Links:
          $ref: "#/components/schemas/OBLinksSelf"
        EventMeta:
          type: "object"
          description: "Event Metadata"
          required: 
          - "EventDateTime"
          - "EventResource"
          - "EventType"
          - "ConsentId"
          properties:
            EventDateTime:
              type: "string"
              format: "date-time"
              description: "Date Time of the first Event in the Message"
            EventResource:
              type: "string"
              description: "The API resource to which the Event itself is associated"
              example: ""
            EventType:
              type: "string"
              enum: ["KSAOB.Resource.Created", "KSAOB.Resource.Updated", "KSAOB.Resource.Deleted"]
              description: "The Type of Event"
            ConsentId:
              description: "Unique identification as assigned to identify the consents resource."
              type: "string"
              minLength: 1
              maxLength: 128
          additionalProperties: false
      additionalProperties: false           
    OBSingleInstantPayment:
      title: "OBSingleInstantPayment"
      type: "object"
      description: |
        A single immediate payment consent that MUST be be used for a single payment which will be initiated immediately after PSU authorization at the PASP.
      required:
        - "Type"
        - "Amount"
      properties:            
        Type: 
          type: "string"
          description: "The Payment Type"
          enum:
          - KSAOB.SingleInstantPayment
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"          
        ExpectedInitiationTimeWindow:
          $ref: "#/components/schemas/OBExpectedInitiationTimeWindow"
      additionalProperties: false
    OBSingleFutureDatedPayment:
      title: "OBSingleFutureDatedPayment"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a single payment which will be authorized by the PSU during the payment journey, but the payment will be initiated by the PISP in the future.
      required:
        - "Type"
        - "Amount"
        - "RequestedExecutionDate"
      properties:            
        Type: 
          type: "string"
          description: "The Payment Type"
          enum:
          - KSAOB.SingleFutureDatedPayment
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"
        RequestedExecutionDate:
          $ref: "#/components/schemas/OBSingleFutureDatedPaymentRequestedExecutionDate"
      additionalProperties: false
    OBFixedRecurringPayment: 
      title: "OBFixedRecurringPayment"
      type: "object"
      description: |
          A long-lived consent that MUST be used for a series of future payments occurring at a predefined fixed schedule (for example periodically) AND each payment is of the same amount.
      required:
        - "Type"
        - "PeriodicSchedule"
        - "TotalNumberOfPayments"
      properties:
        Type:
          description: |
            The Payment Type
          type: "string"
          enum:
          - KSAOB.FixedRecurringPayment
        TotalNumberOfPayments: 
          $ref: "#/components/schemas/OBNumberOfPayments"    
        PeriodicSchedule:
          $ref: "#/components/schemas/OBFixedRecurringPeriodicSchedule"          
      additionalProperties: false
    OBFixedOnDemandPayment: 
      title: "OBFixedOnDemandPayment"
      type: "object"
      description: |
          A long-lived consent that MUST be used for a series of future payments occurring at an unspecified schedule AND each payment is of the same amount.
      required:
        - "Type" 
        - "Amount"
        - "MaximumCumulativeNumberOfPayments"
      properties:                    
        Type:
          description: |
            The Payment Type
          type: "string"
          enum:
          - KSAOB.FixedOnDemandPayment
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"
        MaximumCumulativeNumberOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeNumberOfPayments"     
        MaximumCumulativeValueOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeValueOfPayments"
        PeriodicSchedule:
          $ref: "#/components/schemas/OBAdHocPeriodicSchedule"          
      additionalProperties: false
    OBVariableRecurringPayment:
      title: "OBVariableRecurringPayment"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a series of future payments occurring at a predefined fixed schedule (for example periodically) AND each payment is of different amount which is unknown at the point of consent.
      required: 
      - "Type"
      - "MaximumIndividualPaymentAmount" 
      - "MaximumCumulativeValueOfPayments"
      - "MaximumCumulativeNumberOfPayments"
      - "PeriodicSchedule"
      properties:
        Type:
          description: |
            The type of Payment
          type: "string"
          enum:
          - KSAOB.VariableRecurringPayment
        MaximumIndividualPaymentAmount:
          $ref: "#/components/schemas/OBMaximumIndividualPaymentAmount"
        MaximumCumulativeValueOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeValueOfPayments"
        MaximumCumulativeNumberOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeNumberOfPayments"     
        PeriodicSchedule:
          $ref: "#/components/schemas/OBVariablePeriodicSchedule"   
      additionalProperties: false      
    OBVariableOnDemandPayment:
      title: "OBVariableOnDemandPayment"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a series of future payments occurring at an unspecified schedule AND each payment is of different amount which is unknown at the point of consent.
      required: 
        - "Type"
        - "MaximumIndividualPaymentAmount" 
        - "MaximumCumulativeValueOfPayments"
        - "MaximumCumulativeNumberOfPayments"
      properties:
        Type:
          description: |
            The type of Payment
          type: "string"
          enum:
          - KSAOB.VariableOnDemandPayment
        MaximumIndividualPaymentAmount:
          $ref: "#/components/schemas/OBMaximumIndividualPaymentAmount"
        MaximumCumulativeNumberOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeNumberOfPayments"     
        MaximumCumulativeValueOfPayments:
          $ref: "#/components/schemas/OBMaximumCumulativeValueOfPayments"
        PeriodicSchedule:
          $ref: "#/components/schemas/OBAdHocPeriodicSchedule"          
      additionalProperties: false
    OBVariableDefinedPayment:
      title: "OBVariableDefinedPayment"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a series of future payments occurring at a predefined schedule (for example periodically) AND each payment is of different amount which is pre-defined and known at the point of consent.  
      required: 
        - "Type"
        - "PaymentSchedule"
      properties:
        Type:
          description: |
            The type of Payment
          type: "string"
          enum:
          - KSAOB.VariableDefinedPayment
        PaymentSchedule:      
          $ref: "#/components/schemas/OBDefinedPaymentSchedule"    
      additionalProperties: false
    OBPaymentType:
      type: "string"
      description: |
        The type of Payment being instructed which must match against the Payment Type(s) set under the Consent Schedule
        * KSAOB.SingleInstantPayment is not listed as this payment is automatically staged by the PASP (after Consent Authorization) and not initiated by the PISP
      enum:
        - KSAOB.SingleFutureDatedPayment
        - KSAOB.FixedRecurringPayment
        - KSAOB.FixedOnDemandPayment
        - KSAOB.VariableRecurringPayment
        - KSAOB.VariableOnDemandPayment
        - KSAOB.VariableDefinedPayment
    OBPaymentTypeResponse:
      type: "string"
      description: |
        The type of Payment being instructed which must match against the Payment Type(s) set under the Consent Schedule
      enum:
        - KSAOB.SingleInstantPayment 
        - KSAOB.SingleFutureDatedPayment
        - KSAOB.FixedRecurringPayment
        - KSAOB.FixedOnDemandPayment
        - KSAOB.VariableRecurringPayment
        - KSAOB.VariableOnDemandPayment
        - KSAOB.VariableDefinedPayment
    OBMaximumCumulativeValueOfPayments:
      type: "string"
      description: |
        The maximum cumulative value of all successful payment rails executions under the Consent. 
        Each successful payment rails execution amount (related to the Consent) is added to the total cumulative value of the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBMaximumCumulativeNumberOfPayments: 
      type: "integer"
      description: |
        The maximum cumulative number of all successful payment rails executions under the Consent. 
        Each successful payment rails execution (related to the Consent) is added to the total cumulative number of payments for the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.        
    OBPeriodTypeMaximumCumulativeValueOfPayments:
      type: "string"
      description: |
        The maximum cumulative payment value of all payment initiations per Period Type.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBPeriodTypeMaximumCumulativeValueOfRefunds:
      type: "string"
      description: |
        The maximum cumulative value of all refund initiations per Period Type.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBPeriodTypeMaximumCumulativeNumberOfRefunds: 
      type: "integer"
      description: |
        The maximum frequency of refund initiations per Period Type.
    OBPeriodTypeMaximumCumulativeNumberOfPayments: 
      type: "integer"
      description: |
        The maximum frequency of payment initiations per Period Type.
    OBMaximumIndividualPaymentAmount:
      description: |
        This is the Maximum amount a variable payment related to the Consent can take. 
        All payment amounts must be smaller or equal to this value.   
      type: "string"
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBPeriodType: 
      title: "OBPeriodType"
      type: "string"
      description: |
        The Period Type as defined in Business Rules Section 3.2 Period & Payment Schedule.
        
        A Period may begin from the Consent CreationDateTime if a PeriodStartDate is not provided.

        |Period Type|Description| 
        |-----------|-----------| 
        |Day|A continuous period of time, consisting of 24 consecutive hours, starting from midnight (00:00:00) and finishing at 23:59:59 of the same day. |
        |Week|A continuous period of time, consisting of seven consecutive days, starting from midnight (00:00:00) and finishing at 23:59:59 of the 7th day. |
        |Month|A continuous period of time starting from midnight (00:00:00) of the first day of a month and finishing at 23:59:59 of the last day of that month.|
        |Year|A continuous period of time, consisting of 12 months.|        
      enum:
        - KSAOB.Day
        - KSAOB.Week 
        - KSAOB.Month
        - KSAOB.Year    
    OBPeriodStartDate: 
      title: "OBPeriodStartDate"
      type: "string"
      description: |
        * Payments: Specifies the start date of when a payment schedule begins.
        * Refunds: Specifies the start date of when a refund schedule begins.
        * RTP: Specifies the start date of when a request to pay schedule begins.

        Where this is an optional field, if a value is not provided, then it must default to the Consent CreationDateTime, starting from midnight 00:00:00.
      format: "date"
    OBNumberOfPayments: 
      title: "OBNumberOfPayments"
      type: "integer"  
      description: |
        The total number of payments that can be instructed during the overall recurring payments period
    OBAdHocPeriodicSchedule:
      title: "OBAdHocPeriodicSchedule"
      description: |
        Payment Controls that apply to all payment instructions in a given period under this payment consent. 
      type: "object"
      additionalProperties: false
      required:
        - "PeriodType"
      properties:
        PeriodType: 
          $ref: "#/components/schemas/OBPeriodType"
        PeriodStartDate:
          $ref: "#/components/schemas/OBPeriodStartDate"
        MaximumCumulativeValueOfPaymentsPerPeriodType:
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeValueOfPayments" 
        MaximumCumulativeNumberOfPaymentsPerPeriodType: 
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeNumberOfPayments" 
    OBAdHocPeriodicRefundsLimit:
      title: "OBAdHocPeriodicRefundsLimit"
      description: |
        Payment Controls that apply to all refund instructions in a given period under this refund consent. 
      type: "object"
      additionalProperties: false
      required:
        - "PeriodType"
        - "PeriodStartDate"
      properties:
        PeriodType: 
          $ref: "#/components/schemas/OBPeriodType"
        PeriodStartDate:
          $ref: "#/components/schemas/OBPeriodStartDate"
        MaximumCumulativeValueOfRefundsPerPeriodType:
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeValueOfRefunds" 
        MaximumCumulativeNumberOfRefundsPerPeriodType: 
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeNumberOfRefunds" 
    OBFixedRecurringPeriodicSchedule:
      title: "OBFixedRecurringPeriodicSchedule"
      description: |
        Payment Controls that apply to all payment instructions in a given period under this payment consent. 
      type: "object"
      additionalProperties: false
      required:
        - "PeriodType"
        - "PeriodStartDate"
        - "Amount"
      properties:
        PeriodType: 
          $ref: "#/components/schemas/OBPeriodType"
        PeriodStartDate:
          $ref: "#/components/schemas/OBPeriodStartDate"
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"
    OBDefinedPaymentSchedule:
      title: "OBDefinedPaymentSchedule"
      type: "array"
      description: |
        (Array) A Payment Schedule denoting a list of pre-defined future dated payments all with fixed amounts and dates. 
      minItems: 1
      uniqueItems: true
      items: 
        type: "object"
        additionalProperties: false
        required:
          - "PaymentExecutionDate"
          - "Amount"
        properties:
          PaymentExecutionDate: 
            $ref: "#/components/schemas/OBPaymentExecutionDate"           
          Amount: 
            $ref: "#/components/schemas/OBActiveCurrencyAmount"
    OBPaymentSequenceNumber: 
      title: "OBPaymentSequenceNumber"
      type: "string"
      description: |
        This indicates the underlying sequence of the recurring payment that is being instructed. 
        For example:
        * 1 can represent the first payment instruction
        * 12 can represent the twelfth payment instruction
      minLength: 1
      maxLength: 10      
      pattern: "^[1-9]\\d*$"
    OBVariablePeriodicSchedule:
      title: "OBVariablePeriodicSchedule"
      description: |
        Maximum amounts that can be specified in all payment instructions in a given period under this VP consent. 
      type: "object"
      additionalProperties: false
      required:
        - "PeriodType"
        - "PeriodStartDate"
      properties:
        PeriodType: 
          $ref: "#/components/schemas/OBPeriodType"
        PeriodStartDate:
          $ref: "#/components/schemas/OBPeriodStartDate"
    OBErrorResponse:
      title: "OBErrorResponse"
      description: "An array of detail error codes, and messages, and URLs to documentation to help remediation."
      type: "object"
      properties:
        Errors:
          items:
            $ref: "#/components/schemas/OBError"
          type: "array"
          minItems: 1
      required:
        - "Errors"
      additionalProperties: false
    OBPaymentStatusDetail:
      title: "OBPaymentStatusDetail"
      description: |
        This attribute SHOULD only be returned when the resource Status represents a failed state e.g. : Rejected.
      type: "object"
      required:
        - "Reason"
      properties:        
        Reason:
          type: "object"
          description: |
            A Placeholder for any responses that support a Status
          required:
            - "Code"
          properties:        
            Code:
              type: string
              description: |
                The reason code that represents the downstream System Error.

                **Payments**
                
                |Status|Reason Code|Description| 
                |----------|--|--| 
                |Rejected|KSAOB.Originator.InsufficientFunds|The PASP Debtor Account does not have sufficient funds to complete the payment|
                |Rejected|KSAOB.Originator.AccountIssue|The Originator Account has an issue in sending the payment e.g. Account is inactive, locked, dormant|                
                |Rejected|KSAOB.Receiver.AccountIssue|The Receiver Account has an issue in receiving the payment e.g. Account is inactive, locked, dormant|
                |Rejected|KSAOB.Originator.TransactionNotPermitted|The Originator Account is not permitted to perform the requested transaction|                
                |Rejected|KSAOB.Originator.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                
                |Rejected|KSAOB.Receiver.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                
                |Rejected|KSAOB.Receiver.Timeout |A timeout has occurred on the payment rails|
                |Rejected|KSAOB.Receiver.SystemUnavailable|The payment rails or downstream system is unavailable|
                |Rejected|KSAOB.Originator.Other|Any other reason not specified and applicable to the Originator; details MUST be provided in the Detail field|
                |Rejected|KSAOB.Receiver.Other|Any other reason not specified and applicable to the Receiver; details MUST be provided in the Detail field|
                |Rejected|KSAOB.Originator.SuspectedFraud|The Originator Account has been suspended due to suspected fraud|             
                |Rejected|KSAOB.Receiver.SuspectedFraud|The Receiver Account has been suspended due to suspected fraud|             
              enum:
                - "KSAOB.Originator.InsufficientFunds"
                - "KSAOB.Originator.AccountIssue"
                - "KSAOB.Receiver.AccountIssue"
                - "KSAOB.Originator.TransactionNotPermitted"
                - "KSAOB.Originator.DuplicateTransaction"
                - "KSAOB.Receiver.DuplicateTransaction"
                - "KSAOB.Receiver.Timeout"
                - "KSAOB.Receiver.SystemUnavailable"              
                - "KSAOB.Originator.Other"
                - "KSAOB.Receiver.Other"
                - "KSAOB.Originator.SuspectedFraud"
                - "KSAOB.Receiver.SuspectedFraud"
            Detail:
              type: "string"
              description: "Further details that are specific to the Reason Code"
          additionalProperties: false
        Message:
          $ref: "#/components/schemas/OBMessage"
      additionalProperties: false
    OBRefundStatusDetail:
      title: "OBRefundStatusDetail"
      description: |
        This attribute SHOULD only be returned when the resource Status represents a failed state e.g. : Rejected.
      type: "object"
      required:
        - "Reason"
      properties:        
        Reason:
          type: "object"
          description: |
            A Placeholder for any responses that support a Status
          required:
            - "Code"
          properties:        
            Code:
              type: string
              description: |
                The reason code that represents the downstream System Error.

                **Refunds**
                
                |Status|Reason Code|Description| 
                |----------|--|--| 
                |Rejected|KSAOB.Originator.InsufficientFunds|The PASP Debtor Account does not have sufficient funds to complete the refund|
                |Rejected|KSAOB.Originator.AccountIssue|The Originator Account has an issue in sending the refund e.g. Account is inactive, locked, dormant|                
                |Rejected|KSAOB.Receiver.AccountIssue|The Receiver Account has an issue in receiving the refund e.g. Account is inactive, locked, dormant|
                |Rejected|KSAOB.Originator.TransactionNotPermitted|The Originator Account is not permitted to perform the requested transaction|                
                |Rejected|KSAOB.Originator.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                
                |Rejected|KSAOB.Receiver.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                
                |Rejected|KSAOB.Receiver.Timeout |A timeout has occurred on the payment rails|
                |Rejected|KSAOB.Receiver.SystemUnavailable|The payment rails or downstream system is unavailable|
                |Rejected|KSAOB.Originator.Other|Any other reason not specified and applicable to the Originator; details MUST be provided in the Detail field|
                |Rejected|KSAOB.Receiver.Other|Any other reason not specified and applicable to the Receiver; details MUST be provided in the Detail field|
              enum:
                - "KSAOB.Originator.InsufficientFunds"
                - "KSAOB.Originator.AccountIssue"
                - "KSAOB.Receiver.AccountIssue"
                - "KSAOB.Originator.TransactionNotPermitted"
                - "KSAOB.Originator.DuplicateTransaction"
                - "KSAOB.Receiver.DuplicateTransaction"
                - "KSAOB.Receiver.Timeout"
                - "KSAOB.Receiver.SystemUnavailable"              
                - "KSAOB.Originator.Other"
                - "KSAOB.Receiver.Other"                
            Detail:
              type: "string"
              description: "Further details that are specific to the Reason Code"
          additionalProperties: false
        Message:
          $ref: "#/components/schemas/OBMessage"
      additionalProperties: false
    OBRequestToPayStatusDetail:
      title: "OBRequestToPayStatusDetail"
      description: |
        This attribute SHOULD only be returned when the resource Status represents a failed state e.g. : Rejected, Failed, Cancelled, Expired.
      type: "object"
      required:
        - "Reason"
      properties:        
        Reason:
          type: "object"
          description: |
            A Placeholder for any responses that support a Status
          required:
            - "Code"
          properties:        
            Code:
              type: string
              description: |
                The reason code that represents the downstream System Error.

                **Requests To Pay (RTP)**
                
                |Status|Reason Code|Description| 
                |----------|--|--| 
                |Failed|KSAOB.Originator.AccountIssue|The Originator Account has an issue in processing the RTP request e.g. Account is inactive, locked, dormant|
                |Failed|KSAOB.Receiver.AccountIssue|The Receiver Account has an issue in processing the RTP request e.g. Account is inactive, locked, dorman|
                |Rejected|KSAOB.Originator.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                
                |Rejected|KSAOB.Receiver.DuplicateTransaction|The requested transaction is a duplicate of a previous successfully processed transaction|                                
                |Failed|KSAOB.Receiver.Timeout|A timeout has occurred on the payment rails|
                |Failed|KSAOB.Receiver.SystemUnavailable|The payment rails or downstream system is unavailable|
                |Failed|KSAOB.Originator.SystemUnavailable|The payment rails or downstream system is unavailable|
                |Failed, Cancelled|KSAOB.Originator.Other|Any other reason not specified and applicable to the Originator; details MUST be provided in the Detail field|
                |Rejected, Failed, Cancelled|KSAOB.Receiver.Other|Any other reason not specified and applicable to the Receiver; details MUST be provided in the Detail field|
                |Cancelled|KSAOB.Receiver.CancellationAccepted|The cancellation request has been accepted by the Receiver|
                |Expired|KSAOB.Originator.Expired|The Originator requested window for an RTP response has expired|
                |Failed|KSAOB.Originator.CancelledBeforeSubmission|The Originator PASP has not submitted the RTP request to the Receiver PASP due to invalid information|                                
              enum:
                - "KSAOB.Originator.AccountIssue"
                - "KSAOB.Receiver.AccountIssue"
                - "KSAOB.Originator.DuplicateTransaction"
                - "KSAOB.Receiver.DuplicateTransaction"
                - "KSAOB.Receiver.Timeout"
                - "KSAOB.Receiver.SystemUnavailable"              
                - "KSAOB.Originator.SystemUnavailable"
                - "KSAOB.Originator.Other"
                - "KSAOB.Receiver.Other"
                - "KSAOB.Receiver.CancellationAccepted"
                - "KSAOB.Originator.Expired"
                - "KSAOB.Originator.CancelledBeforeSubmission"
            Detail:
              type: "string"
              description: "Further details that are specific to the Reason Code"
          additionalProperties: false
        Message:
          $ref: "#/components/schemas/OBMessage"
      additionalProperties: false
    OBMessage:
      title: "OBMessage"
      description: "A description of the error that occurred. e.g., 'A mandatory field isn't supplied' or 'RequestedExecutionDateTime must be in future'\nKSAOB doesn't standardise this field"
      type: "object"
      required:
        - "en"
      properties:
        en:
          type: "string"
          description: "English value of the string"
          minLength: 1
          maxLength: 500
        ar:
          type: "string"
          description: "Arabic value of the string"
          minLength: 1
          maxLength: 500
      additionalProperties: false
    OBError:
      title: "OBError"
      description: "Error"
      type: "object"
      required:
        - "Code"
        - "Message"
      additionalProperties: false
      minProperties: 1                
      properties:
        Code:
          description: "Low level textual error code"
          type: "string"
          enum:
            - "KSAOB.AccessToken.Unauthorized"
            - "KSAOB.AccessToken.InvalidScope"
            - "KSAOB.Consent.TransientAccountAccessFailure"
            - "KSAOB.Consent.AccountTemporarilyBlocked"
            - "KSAOB.Consent.PermanentAccountAccessFailure"
            - "KSAOB.Consent.Invalid"
            - "KSAOB.Consent.BusinessRuleViolation"
            - "KSAOB.Consent.FailsControlParameters"
            - "KSAOB.Consent.InvalidPSUIdentifier"
            - "KSAOB.JWS.InvalidSignature"
            - "KSAOB.JWS.Malformed"
            - "KSAOB.JWS.InvalidClaim"
            - "KSAOB.JWS.InvalidHeader"
            - "KSAOB.JWE.DecryptionError"
            - "KSAOB.JWE.InvalidHeader"
            - "KSAOB.GenericRecoverableError"
            - "KSAOB.GenericError"
            - "KSAOB.Event.UnexpectedEvent"
            - "KSAOB.Body.InvalidFormat"
            - "KSAOB.Resource.InvalidResourceId"
            - "KSAOB.Resource.InvalidFormat"
        Message:
          $ref: "#/components/schemas/OBMessage"
        Path:
          description: "Recommended but optional reference to the JSON Path of the field with error, e.g., Data.Initiation.InstructedAmount.Currency"
          type: "string"
          minLength: 1
          maxLength: 500
        Url:
          description: "URL to help remediate the problem, or provide more information, or to API Reference, or help etc"
          type: "string"          
    OBLinksSelf:
      title: "OBLinksSelf"
      type: "object"
      description: "Links relevant to the resource"
      required:
        - "Self"            
      properties:
        Self:
          $ref: "#/components/schemas/OBSelf"
      additionalProperties: false
    OBLinksRelatedConsent:
      title: "OBLinksRelatedConsent"
      type: "object"
      description: "Links relevant to the resource"
      required:
        - "Self"            
        - "Related"            
      properties:
        Self:
          $ref: "#/components/schemas/OBRelatedSinglePayment"
        Related:
          $ref: "#/components/schemas/OBSelfConsent"
      additionalProperties: false
    OBLinksRelatedPayment:
      title: "OBLinksRelatedPayment"
      type: "object"
      description: "Links relevant to the resource"
      required:
        - "Self"            
        - "Related"            
      properties:
        Self:
          $ref: "#/components/schemas/OBSelfConsent"
        Related:
          $ref: "#/components/schemas/OBRelatedPayment"
      additionalProperties: false
    OBPaymentConsumption:
      title: "OBPaymentConsumption"
      type: "object"
      description: |
        Data to track the consumption of Payments in relation to an authorized Consent Schedule
      required:
      - "CumulativeNumberOfPayments"
      - "CumulativeValueOfPayments"
      - "CumulativeValueOfPaymentsPerCurrentPeriod"
      properties:
        CumulativeNumberOfPayments:
          type: "number"
          description: |
            The cumulative number of payment instructions successfully accepted under the current consent schedule (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 4
        CumulativeValueOfPayments:
          description: |
            The cumulative value of payment instructions successfully accepted under the current consent schedule (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "4.00"               
        CumulativeNumberOfPaymentsPerCurrentPeriod:
          type: "number"
          description: |
            The cumulative number of payment instructions in the current period that are successfully accepted (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 1
        CumulativeValueOfPaymentsPerCurrentPeriod:
          description: |
            The cumulative value of payment instructions in the current period that are successfully accepted (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "1.00"                                     
      additionalProperties: false
    OBMeta:
      title: "OBMetaData"
      type: "object"
      description: "Meta Data relevant to the resource"
      additionalProperties: false   
    OBMetaMultiAuthorization:
      title: "OBMetaMultiAuthorization"
      type: "object"
      description: |
        Meta Data with Multi-Authorization relevant to the payload. 
        For a payment, it represents any Authorizers within the PASP domain that are involved in approving the payment request.
      properties:
        MultipleAuthorizers:
          type: "object"
          description: "Multiple Authorizers Schema"
          properties:
            TotalRequired:
              description: |
                The total number of Authorizers required to process the request 
              type: "number"
            Authorizations:
              type: "array"
              items: 
                description: |
                  Authorizer
                type: "object"
                properties:
                  AuthorizerId: 
                    description: |
                      The Authorizer's Identifier
                    type: "string"
                  AuthorizerName: 
                    description: |
                      The Authorizer's Name
                    type: "string"
                  AuthorizerType: 
                    description: |
                      The Type of Authorizer. For example, Financial, Management, etc. 
                    type: "string"
                  AuthorizationDate:
                    description: |
                      The DateTime of when the Authorization occurred. All dates in the JSON payloads are represented in ISO 8601 date-time format. \nAll date-time fields in responses must include the timezone. An example is below:\n2023-04-05T10:43:07+00:00
                    type: "string"
                    format: "date-time"
                  AuthorizationStatus: 
                    description: |
                      The Status reflecting the Authorizer's final decision regarding the request
                    type: "string"
                    enum:
                      - "Pending"
                      - "Approved"
                      - "Rejected"
                additionalProperties: false
          additionalProperties: false
      additionalProperties: false            
    OBSelf:
      title: "OBSelf"
      description: "A link to the current resource"
      type: "string"
      format: "uri"
    OBSelfConsent:
      title: "OBSelfConsent"
      description: "A link to the related payment consents resource"
      type: "string"
      format: "uri"
      example: "/payment-consents/aac-69255d98-ab0e-4758-92a7-cacbf3073efa"
    OBSelfRefundConsent:
      title: "OBSelfRefundConsent"
      description: "A link to the related refund consents resource"
      type: "string"
      format: "uri"
      example: "/refund-consents/aac-69255d98-ab0e-4758-92a7-cacbf3073efa"
    OBSelfRequestToPayConsent:
      title: "OBSelfRequestToPayConsent"
      description: "A link to the related request to pay consents resource"
      type: "string"
      format: "uri"
      example: "/request-to-pay-consents/aac-69255d98-ab0e-4758-92a7-cacbf3073efa"
    OBRelatedSinglePayment:
      title: "OBRelatedSinglePayment" 
      type: string
      format: "uri"
      description: "A link to the current payment resource"
      example: "/payments/83b47199-90c2-4c05-9ef1-aeae68b0fc7c"        
    OBRelatedPayment:
      title: "OBRelatedPayment" 
      description: |
        A link to the related payments resource. 
        
        * For a Single Payment, this Array must have have 1 entry, associated with the Single Payment resource created against this consent. 
        * For Multi-Payment, this Array will have 1 or more entries of all the Payment resources created against this Consent
      type: "array"
      items: 
        type: "string"
      example: []        
    OBPaymentId:
      title: "OBPaymentId"
      description: "An API specific unique identification as assigned by the PASP to identify the domestic Payment resource."
      type: "string"
      minLength: 1
      maxLength: 40
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    OBConsentId:
      title: "OBConsentId"
      description: |
        Unique identification assigned by the PASP to identify the consent resource.
      type: "string"
      minLength: 1
      maxLength: 128
      example: aac-69255d98-ab0e-4758-92a7-cacbf3073efa
    OBBaseConsentId:
      title: "OBBaseConsentId"
      description: |
        Unique identification assigned by the PASP for all consent types (single use and long lived).
        Once assigned by the PASP, its value does not change and therefore remains immutable.
        It is used by the PISP for updating/renewing parameters associated with long-lived consents.
        It must be provided when long-lived consent parameters are updated/renewed for a current consent that has not yet finished.
      type: "string"
      minLength: 1
      maxLength: 128
      example: abc-19877d98-ab0e-4758-92a7-vvffr1234abv
    OBConsentSuspended:
      title: "OBConsentSuspended"
      description: |
        Specifies if a Consent has been Suspended or UnSuspended by the PASP
      type: "object"
      required:
        - "IsConsentSuspended"
        - "ConsentSuspendedUpdateDateTime"
      properties:
        IsConsentSuspended: 
          description: |
            Denotes whether or not the Consent has been suspended by the PASP, pending further enquiries. 
            This could be due to e.g. suspicious fraudulent activity.
          type: "boolean"
          default: false
          example: false
        ConsentSuspendedUpdateDateTime: 
          description: |
            
            * When IsConsentSuspended is set to true, is the Date Time when the Consent was marked as Suspended.
            * When IsConsentSuspended is set to false, is the Date Time when the Consent was marked as UnSuspended  
            
            All dates in the JSON payloads are represented in ISO 8601 date-time format. All date-time fields in responses must include the timezone. An example is below: 2023-04-05T10:43:07+00:00
          type: "string"
          format: "date-time"
    OBCreationDateTime:
      title: "OBCreationDateTime"
      description: "Date and time at which the message was created. All dates in the JSON payloads are represented in ISO 8601 date-time format. \nAll date-time fields in responses must include the timezone. An example is below:\n2023-04-05T10:43:07+00:00"
      type: "string"
      format: "date-time"    
    OBPaymentStatus:
      title: "OBPaymentStatus"
      description: |
        Specifies the status of the payment information group
        * Pending: Payment initiation or individual transaction included in the payment initiation is pending. Further checks and status update will be performed.
        * Rejected: The payment initiation has been rejected
        * AcceptedSettlementCompleted: Settlement of the Debtors account has been completed
        * AcceptedCreditSettlementCompleted: When the Payee account has been credited with the funds of the payment initiated via the PISP
        * AcceptedWithoutPosting:  When the Recipient Bank has accepted the payment but has not applied the credit to the Payee account yet.
      type: "string"
      enum:
        - "Pending"
        - "AcceptedSettlementCompleted"
        - "AcceptedCreditSettlementCompleted"
        - "AcceptedWithoutPosting"
        - "Rejected"
      example: Pending
    OBStatusUpdateDateTime:
      title: "OBStatusUpdateDateTime"
      description: "Date and time at which the resource status was updated.All dates in the JSON payloads are represented in ISO 8601 date-time format. \nAll date-time fields in responses must include the timezone. An example is below:\n2023-04-05T10:43:07+00:00"
      type: "string"
      format: "date-time"
    OBFlagDateTime:
      title: "OBFlagDateTime"
      description: "Date and time at which a Flag has been set. All dates in the JSON payloads are represented in ISO 8601 date-time format. \nAll date-time fields in responses must include the timezone. An example is below:\n2023-04-05T10:43:07+00:00"
      type: "string"
      format: "date-time"
    OBSingleFutureDatedPaymentRequestedExecutionDate:
      title: "OBSingleFutureDatedPaymentRequestedExecutionDate"
      description: |
        The date when the PISP expects the PASP to execute the payment.
        The date must be in the future and cannot be on the same day or a day in the past. 
        The maximum date in the future that can be specified is 1 year from the day of the consent of the PSU to the PISP. 
        All dates in the JSON payloads are represented in ISO 8601 date format.
      type: "string"
      format: "date"
    OBConsentStatus:
      title: "OBConsentStatus"
      description: |
        Specifies the authorization statuses of a consent.

        | Consent Status| State Type| Description|
        |---------------|-----------|------|
        | AwaitingAuthorization | Pending | The consent is awaiting authorization.|
        | Authorized | In Use | The consent has been successfully authorized.  |
        | Rejected | Terminal | The unauthorized consent has been canceled at the TPP/PISP or rejected at the PASP.|
        | Finished | Terminal | The consented action(s) have either been completed successfully, the consent has expired, or the authorized consent has been revoked.|
      type: "string"
      enum:
        - "AwaitingAuthorization"
        - "Authorized"
        - "Rejected"
        - "Finished"
    OBConsentFlags:
      title: "OBConsentFlags"
      description: |
        Flags that are associated with a Consent Status.
        
        A Consent Status: 
        * May not have any associated flags.
        * May have one or more associated flags.
        
        A Flag cannot be changed once it is created. Its state is Immutable.
        Each Flag value that is set must have a date time stamp associated with it.

        |Flag| Consent Status| Flag Description|
        |----|---------------|-----------------|
        | PartlyAuthorized | AwaitingAuthorization | The initiator has authorized the consent and is awaiting further authorizations.|
        | Activated |Authorized | The authorized long-lived consent is being utilized.|
        | Revoked | Finished | An authorized consent has been revoked |
        | Expired | Finished | The consent has expired |
        | Consumed | Finished| The consented action has been completed successfully.|
        | Closed | Finished | The consent has finished with no further inquiries permitted.|
        | Amended | Finished | The consent (parameters) has been amended / renewed.|
        | |Rejected| The unauthorized consent has been canceled at the TPP or rejected at the PASP.
      type: "object"
      properties:
        PartlyAuthorized:
          $ref: "#/components/schemas/OBFlagDateTime"
        Activated:
          $ref: "#/components/schemas/OBFlagDateTime"
        Revoked:
          $ref: "#/components/schemas/OBFlagDateTime"
        Expired:
          $ref: "#/components/schemas/OBFlagDateTime"
        Consumed:
          $ref: "#/components/schemas/OBFlagDateTime"
        Closed:
          $ref: "#/components/schemas/OBFlagDateTime"
        Amended:
          $ref: "#/components/schemas/OBFlagDateTime"
      additionalProperties: false 
    OBPatchConsentStatus:
      title: "OBConsentStatus"
      description: |
        Specifies the authorization statuses of a consent.

        | Consent Status| State Type| Description|
        |---------------|-----------|------|
        | Rejected | Terminal | The unauthorized consent has been canceled at the TPP/PISP or rejected at the PASP.|
        | Finished | Terminal | The consented action(s) have either been completed successfully, the consent has expired, or the authorized consent has been revoked.|
      type: "string"
      enum:
        - "Rejected"
        - "Finished"
    OBPatchConsentFlags:
      title: "OBPatchConsentFlags"
      description: |
        Flags that can be associated with a Consent Status.
        The Flag cannot be changed once it is created. Its state is Immutable.
          Each Flag value that is set must have a date time stamp associated with it.


        |Flag| Consent Status| Flag Description|
        |----|---------------|-----------------|
        | Revoked | Finished | An authorized consent has been revoked |
      type: "object"
      properties:
        Revoked:
          $ref: "#/components/schemas/OBFlagDateTime"
      additionalProperties: false
    OBAcceptedAuthorizationTypeRequestPayments:
      title: "OBAcceptedAuthorizationType"
      description: |
        Specifies to the PASP the type of consent authorization accepted by the PISP when staging the consent
        * Single - The consent should incur a single authorization Step with the PASP
        * Multi - The consent should incur a multi-authorization Step with the PASP
        * Both - The consent should incur either a single authorization or multi-authorization step with the PASP. The PASP decides.
      type: "string"
      enum:
        - "KSAOB.Single"
        - "KSAOB.Multi"
        - "KSAOB.Both"
    OBAcceptedAuthorizationType:
      title: "OBAcceptedAuthorizationType"
      description: |
        Specifies to the PASP the type of consent authorization accepted by the PISP when staging the consent
        * Single - The consent should incur a single authorization Step with the PASP
        * Multi - The consent should incur a multi-authorization Step with the PASP
      type: "string"
      enum:
        - "KSAOB.Single"
        - "KSAOB.Multi"
    OBAuthorizationExpirationTimeWindow:
      title: "OBAuthorizationExpirationTimeWindow" 
      description: |
        A time window by which a Consent (in AwaitingAuthorization status) must be Authorized by the PSU.
        The time window starts from the actual CreationDateTime (when the Consent is staged with the PASP). 
        If the current time window exceeds the Authorization Expiration Time Window (and the Consent status is AwaitingAuthorization) then the Consent Status must be set to Rejected.
        The time window is based on a custom time format hhh:mm:ss. e.g. 720:00:00 represents a time window of 720 hours, 00 minutes, 00 seconds (30 days) after the CreationDateTime to Authorize the Consent.  
      type: "string"
      pattern: '^(00[0-9]|0[1-9][0-9]|[1-6][0-9]{2}|7[01][0-9]|720):[0-5][0-9]:[0-5][0-9]$'
      example: "720:00:00"
    OBExpectedInitiationTimeWindow:
      title: "OBExpectedInitiationTimeWindow" 
      description: |
        A time window set by the PISP in which a Payment must be initated by the PASP.
        The time window is based on a custom time format hhh:mm:ss. e.g. 000:00:15 represents a time window of 15 seconds to initiate the Payment.  
      type: "string"
      pattern: '^(00[0-9]|0[1-9][0-9]|[1-6][0-9]{2}|7[01][0-9]|720):[0-5][0-9]:[0-5][0-9]$'
      example: "000:00:15"
    OBPaymentConsentRequest:
      title: "OBPaymentConsentRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ControlParameters"
            - "Initiation"
            - "PaymentPurposeCode"
            - "AcceptedAuthorizationType"
          properties:
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationTypeRequestPayments"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the Payment Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                IsPayByAccount:
                  $ref: "#/components/schemas/OBIsPayByAccount"
                ConsentSchedule:
                  type: "object"
                  description: |
                    The various payment types that can be initiated:
                    * A Single Payment
                    * A Multi-Payment
                    * A Combined Payment (one SinglePayment and one MultiPayment)
                  properties:
                    SinglePayment:
                      description: |
                        A Consent definition for defining Single Payments
                      oneOf:
                        - $ref: "#/components/schemas/OBSingleInstantPayment"          
                        - $ref: "#/components/schemas/OBSingleFutureDatedPayment"
                      discriminator:
                        propertyName: Type                        
                    MultiPayment:
                      description: |
                        A Consent definition for defining Multi Payments
                      oneOf:
                        - $ref: "#/components/schemas/OBFixedRecurringPayment"          
                        - $ref: "#/components/schemas/OBFixedOnDemandPayment"          
                        - $ref: "#/components/schemas/OBVariableRecurringPayment"
                        - $ref: "#/components/schemas/OBVariableOnDemandPayment"
                        - $ref: "#/components/schemas/OBVariableDefinedPayment"
                      discriminator:
                        propertyName: Type                        
                  additionalProperties: false                  
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "CreditorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a single domestic payment."
              properties:
                DebtorAccount:
                  type: "object"
                  additionalProperties: false
                  required:
                    - "IdentificationType"
                    - "Identification"
                  description: "Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction."
                  properties:
                    IdentificationType:
                      $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
                    Identification:
                      $ref: "#/components/schemas/OBIdentification"
                    Name:
                     $ref: "#/components/schemas/OBName"
                CreditorAgent:
                  $ref: "#/components/schemas/OBCreditorAgent"
                CreditorAccount:
                  $ref: "#/components/schemas/OBCreditorAccount"
            PayerNotes:
              $ref: "#/components/schemas/OBPayerNote"
            BeneficiaryInformation:
              description: |
                Beneficiary Information regarding the Payment
              oneOf:
                - $ref: "#/components/schemas/OBBeneficiaryNote"          
                - $ref: "#/components/schemas/OBBeneficiaryOrderId"
                - $ref: "#/components/schemas/OBPSUReference"
            PaymentPurposeCode:
              $ref: "#/components/schemas/OBPaymentPurposeCode"           
            SponsoredTPPInformation:
              $ref: "#/components/schemas/OBSponsoredTPPInformation"
        Risk:
          $ref: "#/components/schemas/OBRisk"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBPaymentRequest:
      title: "OBPaymentRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ConsentId"
            - "Instruction"
            - "Type"
            - "PaymentPurposeCode"
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type:
              $ref: "#/components/schemas/OBPaymentType"          
            Instruction:
              $ref: "#/components/schemas/OBPaymentInstruction"
            PaymentPurposeCode:
              $ref: "#/components/schemas/OBPaymentPurposeCode"           
            PayerNotes:
              $ref: "#/components/schemas/OBPayerNote"
        Risk:
          $ref: "#/components/schemas/OBRisk"
    OBCreditorAgent:
      title: "OBCreditorAgent"
      description: |
         Refers to the Financial Institution.
      type: "object"
      required:
        - "IdentificationType"
        - "Identification"
      properties:
        IdentificationType:
          type: "string"
          description: |
            Refers to the Identification scheme for uniquely identifying the Agent.

            * KSAOB.OTHER: The ID; A Country Code followed by a Bank Code (KSAOB 4 character code). The full list of PASP names and 6 digits IDs are as follows:
          enum:
            - "KSAOB.OTHER"
        Identification:
          description: |
            The Agent is the Country Code followed by a Bank Code (KSAOB 4 character code). The full list of PASP names and 6 digits IDs are as follows"
            
            | PASP NAME|ID| 
            |----------|--| 
            |ALINMA BANK|SAINMA|
            |AL RAJHI BANK|SARJHI|
            |ARAB NATIONAL BANK|SAARNB|
            |BANK AL BILAD|SAALBI|
            |BANK AL-JAZIRA|SABJAZ|
            |BANK MUSCAT|SABMUS|
            |BANQUE SAUDI FRANSI|SABSFR|
            |BNP PARIBAS SAUDI ARABIA|SABNPA|
            |CREDIT SUISSE SAUDI ARABIA|SACRES|
            |DEUTSCHE BANK AG, RIYADH BRANCH|SADEUT|
            |EMIRATES NBD PJSC|SAEBIL|
            |FIRST ABU DHABI BANK|SAFABM|            
            |GULF INTERNATIONAL BANK B.S.C., RIYADH|SAGULF|
            |INDUSTRIAL AND COMMERCIAL BANK OF CHINA RIYADH BRANCH, SA|SAICBK|
            |ISLAMIC DEVELOPMENT BANK|SAISLD|
            |J.P.MORGAN SAUDI ARABIA LIMITED|SAJPMG|
            |J.P MORGAN CHASE BANK, N.A RIYADH|SACHAS|        
            |MERILL LYNCH KINGDOM OF SAUDIA ARABIA|SAMLSA|
            |NATIONAL BANK OF BAHRAIN|SANBOB|
            |NATIONAL BANK OF KUWAIT|SANBOK|
            |NATIONAL BANK OF PAKISTAN|SANBPA|
            |NEOLEAP|SANEOL|    
            |RIYAD BANK|SARIBL|
            |SAUDI NATIONAL BANK|SANCBK|
            |SAUDI ARABIAN MONETARY AUTHORITY|SASAMA|
            |SAUDI BRITISH BANK|SASABB|
            |SAUDI INVESTMENT BANK|SASIBC|
            |STANDARD CHARTERED CAPITAL (SAUDI ARABIA)|SASCBL|
            |STC PAY|SASTCP|
            |STC Bank|SASTCJ|            
            |T.C. ZIRAAT BANKASI A.S|SATCZB|
          type: "string"
          enum:
            - "SAINMA"
            - "SARJHI"
            - "SAALBI"
            - "SABJAZ"
            - "SABMUS"
            - "SABSFR"
            - "SABNPA"
            - "SACRES"
            - "SADEUT"
            - "SAEBIL"
            - "SAGULF"
            - "SAICBK"
            - "SAISLD"
            - "SAJPMG"
            - "SACHAS"
            - "SAMLSA"
            - "SANBOB"
            - "SANBOK"
            - "SANBPA"
            - "SANCBK"
            - "SARIBL"
            - "SASAMA"
            - "SASABB"
            - "SASIBC"
            - "SASCBL"
            - "SATCZB"
            - "SASTCP"
            - "SANEOL"
            - "SASTCJ"
            - "SAFABM"
          minLength: 6
          maxLength: 6
          example: SASAMA            
    OBPaymentConsentResponse:
      title: "OBPaymentConsentResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ConsentId"
            - "BaseConsentId"
            - "ConsentStatus"
            - "ConsentStatusUpdateDateTime"
            - "Initiation"
            - "CreationDateTime"
            - "ControlParameters"
            - "PaymentPurposeCode"
            - "PaymentConsumption"
            - "AcceptedAuthorizationType"
            - "ExpirationDateTime"
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"   
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationType"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ConsentStatus:
              $ref: "#/components/schemas/OBConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBConsentFlags"            
            RevokedBy:
               $ref: "#/components/schemas/OBRevokedBy"
            ConsentSuspended:
               $ref: "#/components/schemas/OBConsentSuspended"               
            ConsentStatusUpdateDateTime:
              $ref: "#/components/schemas/OBStatusUpdateDateTime"
            CreationDateTime:
                $ref: "#/components/schemas/OBCreationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the Payment Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                IsPayByAccount:
                  $ref: "#/components/schemas/OBIsPayByAccount"
                ConsentSchedule:
                  type: "object"
                  description: |
                    The various payment types that can be initiated:
                    * A Single Payment
                    * A Multi-Payment
                    * A Combined Payment (one SinglePayment and one MultiPayment)
                  properties:
                    SinglePayment:
                      description: |
                        A Consent definition for defining Single Payments
                      oneOf:
                        - $ref: "#/components/schemas/OBSingleInstantPayment"          
                        - $ref: "#/components/schemas/OBSingleFutureDatedPayment"
                      discriminator:
                        propertyName: Type                        
                    MultiPayment:
                      description: |
                        A Consent definition for defining Multi Payments
                      oneOf:
                        - $ref: "#/components/schemas/OBFixedRecurringPayment"          
                        - $ref: "#/components/schemas/OBFixedOnDemandPayment"          
                        - $ref: "#/components/schemas/OBVariableRecurringPayment"
                        - $ref: "#/components/schemas/OBVariableOnDemandPayment"
                        - $ref: "#/components/schemas/OBVariableDefinedPayment"
                      discriminator:
                        propertyName: Type                        
                  additionalProperties: false                  
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "CreditorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor."
              properties:
                DebtorAccount:
                  type: "object"
                  additionalProperties: false
                  required:
                    - "IdentificationType"
                    - "Identification"
                  description: "Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction."
                  properties:
                    IdentificationType:
                      $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
                    Identification:
                      $ref: "#/components/schemas/OBIdentification"
                    Name:
                     $ref: "#/components/schemas/OBName"
                CreditorAgent:
                  $ref: "#/components/schemas/OBCreditorAgent"
                CreditorAccount:  
                  $ref: "#/components/schemas/OBCreditorAccount"                  
            PayerNotes:
              $ref: "#/components/schemas/OBPayerNote"
            BeneficiaryInformation:
              description: |
                Beneficiary Information regarding the Payment
              oneOf:
                - $ref: "#/components/schemas/OBBeneficiaryNote"          
                - $ref: "#/components/schemas/OBBeneficiaryOrderId"
                - $ref: "#/components/schemas/OBPSUReference"
            PaymentPurposeCode:
              $ref: "#/components/schemas/OBPaymentPurposeCode"           
            SponsoredTPPInformation:
              $ref: "#/components/schemas/OBSponsoredTPPInformation"
            PaymentConsumption:
              $ref: "#/components/schemas/OBPaymentConsumption"          
        Risk:
          $ref: "#/components/schemas/OBRisk"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"          
        Links:
          $ref: "#/components/schemas/OBLinksRelatedPayment"    
        Meta:
          $ref: "#/components/schemas/OBMetaMultiAuthorization"          
    OBPaymentIdResponse:
      title: "OBPaymentIdResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "PaymentId"
            - "ConsentId"
            - "PaymentStatus"
            - "PaymentStatusUpdateDateTime"
            - "Instruction"
            - "Type"
            - "CreationDateTime"
            - "PaymentPurposeCode"
            - "DebtorCharges"
            - "PaymentTransactionId"
          properties:
            PaymentId:
              $ref: "#/components/schemas/OBPaymentId"
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type:
              $ref: "#/components/schemas/OBPaymentTypeResponse"          
            PaymentTransactionId:
              $ref: "#/components/schemas/OBPaymentTransactionId"
            PaymentStatus:
              $ref: "#/components/schemas/OBPaymentStatus"
            PaymentStatusUpdateDateTime:
              $ref: "#/components/schemas/OBStatusUpdateDateTime"
            PaymentStatusDetail:
              $ref: "#/components/schemas/OBPaymentStatusDetail"                          
            CreationDateTime:
                $ref: "#/components/schemas/OBCreationDateTime"
            DebtorCharges:
               $ref: "#/components/schemas/OBCharges"
            Instruction:
              $ref: "#/components/schemas/OBPaymentInstruction"    
            PaymentPurposeCode:
              $ref: "#/components/schemas/OBPaymentPurposeCode"      
            PayerNotes:
              $ref: "#/components/schemas/OBPayerNote"
        Risk:
          $ref: "#/components/schemas/OBRisk"
        Links:
          $ref: "#/components/schemas/OBLinksRelatedConsent"    
        Meta:
          $ref: "#/components/schemas/OBMeta"         
    OBPaymentInstruction:
      title: "OBPaymentInstruction"
      type: "object"
      additionalProperties: false
      required:
        - "Amount"
        - "PaymentSequenceNumber"
      description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a single domestic payment."
      properties:
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"
        BeneficiaryInformation:
          description: |
            Beneficiary Information regarding the Payment
          oneOf:
            - $ref: "#/components/schemas/OBBeneficiaryNote"          
            - $ref: "#/components/schemas/OBBeneficiaryOrderId"
            - $ref: "#/components/schemas/OBPSUReference"
        PaymentSequenceNumber:
          $ref: "#/components/schemas/OBPaymentSequenceNumber"
    OBPaymentExecutionDate: 
      title: "OBPaymentExecutionDate"
      description: |
        Used to specify the expected payment execution date/time.
        All dates in the JSON payloads are represented in ISO 8601 date format.
        An example is: 2023-04-05
      type: "string"
      format: "date"
    OBActiveCurrencyAmount:
      title: "OBActiveCurrencyAmount"
      description: |
        The Currency and Amount relating to the Payment, Refund or Request to Pay      
      type: "object"
      required:
        - "Amount"
        - "Currency"
      properties:
        Amount:
          $ref: "#/components/schemas/OBActiveOrHistoricAmount"
        Currency:
          $ref: "#/components/schemas/OBActiveOrHistoricCurrencyCode"
    OBActiveOrHistoricAmount:
      title: "OBActiveOrHistoricAmount"
      description: "A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
      type: "string"
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBActiveOrHistoricCurrencyCode:
      title: "OBActiveOrHistoricCurrencyCode"
      description: "A 3 character alphabetic code allocated to a currency under an international currency identification scheme, as described in the latest edition of the international standard ISO 4217 'Codes for the representation of currencies and funds'."
      type: "string"
      pattern: "^[A-Z]{3,3}$"
      example: "SAR"
    OBExternalAccountIdentificationCode:
      title: "OBExternalAccountIdentificationCode"
      description: "Name of the identification scheme, in a coded form as published in an external list."
      type: "string"
      enum:
        - "KSAOB.IBAN"
        - "KSAOB.AccountNumber"
        - "KSAOB.UnifiedCommercialNumber"
        - "KSAOB.Email"
        - "KSAOB.MobileNumber"
        - "KSAOB.NationalID"
        - "KSAOB.IqamaNumber"
    OBIdentification:
      title: "OBIdentification"
      description: |
        Identification for the account assigned by the PASP based on the Account Scheme Name. 
        This identification is known by the PSU account owner. 
      type: "string"
      minLength: 1     
    OBName:
      title: "OBName"
      type: "object"
      description: |
        The Account Holder Name is the name or names of the Account owner(s) represented at the account level
      properties:
        en:
          type: "string"
          description: "English value of the string"
        ar:
          type: "string"
          description: "Arabic value of the string"
      additionalProperties: false
    OBTradingName:
      title: "OBTradingName"
      type: "object"
      description: |
        The Trading Brand Name (if applicable) for the Creditor. 
        Applicable to Payments.
      properties:
        en:
          type: "string"
          description: "English value of the string"
        ar:
          type: "string"
          description: "Arabic value of the string"
      additionalProperties: false
    OBPSUReference:
      title: "OBPSUReference"
      type: "object"
      description: |
        Information supplied by the PSU against Recurring and Variable Payments.
        Please see Business Rules 3.3 Fixed Recurring Payment-Consent PSU Reference
      required:
        - "PSUReference"
      properties:
        PSUReference:
          description: |
            Information supplied by the PSU to enable a unique reference for the Payment.
          type: "string"
          minLength: 1
          maxLength: 35      
      additionalProperties: false
    OBPayerNote:
      title: "OBPayerNote"
      description: |
        The Payer note is for the PSUs reference and may be available to PSUs as additional information in relation to a payment by their PASPs. 
        If a Payer note is provided in the consent, it can also be used as the default value for each recurring Payment instruction.        
      type: "string"
      minLength: 1
      maxLength: 256
    OBExternalPaymentChargeTypeCode:
      title: "OBExternalPaymentChargeTypeCode"
      description: "Charge type, in a coded form."
      type: "string"
      enum:
        - "VAT"
        - "Fees"
    OBCharges:
      title: "OBCharges"
      type: "array"
      items:
        type: "object"
        additionalProperties: false
        description: |
          Set of elements used to provide details of a charge for the payment initiation.
          * For Payments, these Charges are on the Debtor.
        required:
          - "Type"
          - "Amount"
        properties:
          Type:
            $ref: "#/components/schemas/OBExternalPaymentChargeTypeCode"
          Amount:
            $ref: "#/components/schemas/OBActiveCurrencyAmount"
    OBPatchRTPConsentSigned: 
      title: "OBPatchRTPConsentSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPatchRTPConsent'
          required: [message]              
    OBPatchRTPConsent:
      title: "OBPatchRTPConsent"
      description: "Patch Requests to Pay Consent"
      type: "object"
      properties:
        Data:
          type: "object"
          description: "Primary data for the resource"
          required:
            - "ConsentStatus"
          properties:
            ConsentStatus:
              $ref: "#/components/schemas/OBPatchConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBPatchConsentFlags"  
            RevokedBy:
              $ref: "#/components/schemas/OBRevokedByPatchConsent"              
          additionalProperties: false
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBPatchRefundConsentSigned: 
      title: "OBPatchRefundConsentSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPatchRefundConsent'
          required: [message]              
    OBPatchRefundConsent:
      title: "OBPatchRefundConsent"
      description: "Patch Refund Consent"
      type: "object"
      properties:
        Data:
          type: "object"
          description: "Primary data for the resource"
          required:
            - "ConsentStatus"
          properties:
            ConsentStatus:
              $ref: "#/components/schemas/OBPatchConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBPatchConsentFlags"  
            RevokedBy:
              $ref: "#/components/schemas/OBRevokedByPatchConsent"              
          additionalProperties: false
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBPatchPaymentConsentSigned: 
      title: "OBPatchPaymentConsentSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBPatchPaymentConsent'
          required: [message]              
    OBPatchPaymentConsent:
      title: "OBPatchPaymentConsent"
      description: "Patch Payment Consent"
      type: "object"
      properties:
        Data:
          type: "object"
          description: "Primary data for the resource"
          required:
            - "ConsentStatus"
          properties:
            ConsentStatus:
              $ref: "#/components/schemas/OBPatchConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBPatchConsentFlags"  
            RevokedBy:
              $ref: "#/components/schemas/OBRevokedByPatchConsent"              
          additionalProperties: false
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBRisk:
      title: "OBRisk"
      additionalProperties: false
      description: |
        The Risk section is sent by the PISP to the PASP. It is used to specify additional details for risk/fraud scoring regarding Payments.
      type: "object"
      properties:
        PSUIndicators:
          $ref: "#/components/schemas/OBPSUIndicators"
        DestinationDeliveryAddress:
          type: "object"
          description: |
            Destination Delivery Address
          properties:     
            RecipientType:
              type: "string"
              description: "The recipient of the goods whether an individual or a corporation." 
              enum:
                - "KSOAB.Individual"     
                - "KSOAB.Corporate"
            RecipientName: 
              type: "object"
              description: "The name of the recipient of the goods, whether an individual or a corporation."
              properties:
                en:
                  type: "string"
                  description: "English value of the string"
                ar:
                  type: "string"
                  description: "Arabic value of the string"     
            NationalAddress:
              $ref: "#/components/schemas/OBAddress"
        TransactionIndicators:
          $ref: "#/components/schemas/OBTransactionIndicators" 
        BeneficiaryIndicators:
          $ref: "#/components/schemas/OBBeneficiaryIndicators"  
    OBRiskPSUIndicators:
      description: |
        The Risk section is sent by the PISP to the PASP. It is used to specify additional details for risk/fraud scoring.
      type: "object"
      properties:
        PSUIndicators:
          $ref: "#/components/schemas/OBPSUIndicators"
        TransactionIndicators:
          $ref: "#/components/schemas/OBTransactionIndicators" 
    OBPaymentPurposeCode:
      title: "OBPaymentPurposeCode:"
      description: |
        A Category code, related to the type of services or goods that corresponds to the underlying purpose of the Payment, Refund, RTP.
        The Purpose Codes can be based on either:        
        * The SARIE IPS Message Implementation Guide - Section 21.4 - Category Purpose Codes
        * The ISO20022 External code sets
      type: "string"
      minLength: 1
      maxLength: 4
      pattern: "^[A-Z]{3,4}$"
    OBPaymentTransactionId:
      title: "OBPaymentTransactionId"
      type: "string"
      description: |
        This is an end to end TransactionId that is associated with a payment when it is sent from an Originating PASP to a Receiving PASP.
        This identifier is also used for Refunds.

        This applies to:
        * Same Bank Transfer (Within the same bank)
        * Local Bank Transfer (Between 2 banks)
        
        **IPS**
        Transaction Identification field (2.4) as defined in the Payment Identification block (2.1) of the Credit Transfer pacs.008 message
        (e.g) 20201122SAABCD00002BXXX20730997766

        **ON-US**
        MUST prefix with a 6 digit bank codes (as per the OBCreditorAgent schema):
        SA + 4 char code. (e.g. SASAMA)
      minimum: 1
      maximum: 35
    OBRTPPayerNote:
      title: "OBRTPPayerNote"
      type: "string"
      description: |
        Notes for the Payer
      minLength: 1
      maxLength: 256
    OBBeneficiaryNote:
      title: "OBBeneficiaryNote"
      type: "object"
      description: |         
        Beneficiary Note may be populated by the PSU (i.e. payer) using information requested by the beneficiary or any other information the PSU wants to provide to the beneficiary to assist in identifying and reconciling the payment. 
        This information will be transferred via the payment rails to the beneficiary PASP, if different than the PSUs PASP.
        Please refer to Generic Business Rules 4.2.8 Beneficiary-Note
      required:
      - "Notes"
      properties:
        Notes:
          description: |
            Notes regarding the payment for the Beneficiary.
          type: "string"
          minLength: 1
          maxLength: 256
      additionalProperties: false
    OBBeneficiaryOrderId:
      title: "OBBeneficiaryOrderId"
      type: "object"
      description: |
        A reference generated by the merchant referencing the order related to the payment or another unique reference in the context of the merchant. 
        This information will be transferred via the payment rails to the beneficiary PASP.  
        Please refer to Business Rules 6.4 Order-ID
      required:
        - "OrderId"
      properties:
        OrderId:
          type: "string"
          minLength: 1
          maxLength: 256
          description: |
            A reference generated by the merchant referencing the order related to the payment or another unique reference in the context of the merchant. 
            This information will be transferred via the payment rails to the beneficiary PASP.  
      additionalProperties: false
    OBSponsoredTPPInformation:
      title: "OBSponsoredTPPInformation"
      type: "object"
      description: |
        The Sponsored TPP is:
        * A TPP that itself has no direct Open Banking API integrations. 
        * A TPP that is using the integration of another TPP that does have direct Open Banking API integrations.  
      properties:
        Name:
          type: "string"
          minLength: 1
          maxLength: 50
          description: |
            The Sponsored TPP Name 
        Identification:
          type: "string"
          minLength: 1
          maxLength: 50
          description: |
            The Sponsored TPP Identification 
      additionalProperties: false
    OBIsPayByAccount:
      type: boolean
      description: |
        A flag to denote if the Payment is an E-Commerce transaction 
      default: false
    OBDomesticRefundConsentResponseSigned:
      title: "OBDomesticRefundConsentResponseSigned"
      allOf:
        - $ref: '#/components/schemas/OBJwt'
        - type: "object"
          properties:
            message:
              $ref: '#/components/schemas/OBRefundConsentResponse'
          required: [message]               
    OBRefundConsentResponse:
      title: "OBRefundConsentResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ConsentId"
            - "BaseConsentId"
            - "ConsentStatus"
            - "ConsentStatusUpdateDateTime"
            - "Initiation"
            - "CreationDateTime"
            - "ControlParameters"
            - "RefundConsumption"
            - "AcceptedAuthorizationType"
            - "ExpirationDateTime"
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationType"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ConsentStatus:
              $ref: "#/components/schemas/OBConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBConsentFlags"      
            RevokedBy:
               $ref: "#/components/schemas/OBRevokedBy"
            ConsentSuspended:
               $ref: "#/components/schemas/OBConsentSuspended"               
            ConsentStatusUpdateDateTime:
              $ref: "#/components/schemas/OBStatusUpdateDateTime"
            CreationDateTime:
                $ref: "#/components/schemas/OBCreationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the Refund Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                ConsentSchedule:
                  type: "object"
                  description: |
                    A list of the various Refund types that can be initiated
                  oneOf:
                    - $ref: "#/components/schemas/OBSingleRefundConsent"          
                    - $ref: "#/components/schemas/OBLongLivedRefundConsent"
                  discriminator:
                    propertyName: Type                        
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "DebtorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a refund."
              properties:
                DebtorAccount:
                  type: "object"
                  additionalProperties: false
                  required:
                    - "IdentificationType"
                    - "Identification"
                  description: "Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction."
                  properties:
                    IdentificationType:
                      $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
                    Identification:
                      $ref: "#/components/schemas/OBIdentification"
                    Name:
                      $ref: "#/components/schemas/OBName"
            RefundConsumption:
              $ref: "#/components/schemas/OBRefundConsumption"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"          
        Links:
          $ref: "#/components/schemas/OBLinksRelatedRefund"    
        Meta:
          $ref: "#/components/schemas/OBMetaMultiAuthorization"          
    OBLinksRelatedRefund:
      title: "OBLinksRelatedRefund"
      type: "object"
      description: "Links relevant to the resource"
      required:
        - "Self"            
        - "Related"            
      properties:
        Self:
          $ref: "#/components/schemas/OBSelfRefundConsent"
        Related:
          $ref: "#/components/schemas/OBRelatedRefund"
      additionalProperties: false
    OBRefundConsumption:
      title: "OBRefundConsumption"
      type: "object"
      description: |
        Data to track the consumption of Refunds in relation to an authorized Consent Schedule
      required:
      - "CumulativeNumberOfRefunds"
      - "CumulativeValueOfRefunds"
      - "CumulativeValueOfRefundsPerCurrentPeriod"
      properties:
        CumulativeNumberOfRefunds:
          type: "number"
          description: |
            The cumulative number of refunds instructions successfully accepted under the current consent schedule (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 4
        CumulativeValueOfRefunds:
          description: |
            The cumulative value of refunds instructions successfully accepted under the current consent schedule (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "4.00"               
        CumulativeNumberOfRefundsPerCurrentPeriod:
          type: "number"
          description: |
            The cumulative number of refund instructions in the current period that are successfully accepted (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 1
        CumulativeValueOfRefundsPerCurrentPeriod:
          description: |
            The cumulative value of payment instructions in the current period that are successfully accepted (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "1.00"                                     
      additionalProperties: false
    OBRelatedRefund:
      title: "OBRelatedRefund" 
      type: "array"
      description: |
        A link to the related refunds resource.
        
        * This Array will contain entries for all the Refund resources created against this Consent.
      items: 
        type: "string"
      example: []        
    OBRefundConsentRequest:
      title: "OBRefundConsentRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ControlParameters"
            - "AcceptedAuthorizationType"
          properties:
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationType"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the Refund Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                ConsentSchedule:
                  type: "object"
                  description: |
                    A list of the various Refund types that can be initiated
                  oneOf:
                    - $ref: "#/components/schemas/OBSingleRefundConsent"          
                    - $ref: "#/components/schemas/OBLongLivedRefundConsent"
                  discriminator:
                    propertyName: Type                        
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "DebtorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a refund."
              properties:
                DebtorAccount:
                  type: "object"
                  additionalProperties: false
                  required:
                    - "IdentificationType"
                    - "Identification"
                  description: "Unambiguous identification of the account of the debtor to which a debit entry will be made as a result of the transaction."
                  properties:
                    IdentificationType:
                      $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
                    Identification:
                      $ref: "#/components/schemas/OBIdentification"
                    Name:
                     $ref: "#/components/schemas/OBName"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBRefundRequest:
      title: "OBRefundRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          required:
            - "ConsentId"
            - "Type"
            - "Instruction"
          additionalProperties: false
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type: 
              type: "string"  
              description: "The Refund Type"
              enum:
              - KSAOB.LongLivedRefund
            Instruction:
              $ref: "#/components/schemas/OBRefundInitiationInstruction"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
    OBRefundInitiationInstruction:
      title: "OBRefundInitiationInstruction"
      description: |
        (Array) of Refund Instructions

        * Please refer to the Business Rules, PIS Limits and Constants, Maximum Refunds per Message for the limit.
      type: "array"
      minItems: 1
      maxItems: 500
      items: 
        required:
          - "Amount"
          - "OriginalPayment"
          - "RefundPurposeCode"
        properties:                  
          Amount:
            $ref: "#/components/schemas/OBActiveCurrencyAmount"
          OriginalPayment:
            allOf:
              - $ref: "#/components/schemas/OBSingleRefundPayment"
            type: "object"
            required:
              - "PaymentTransactionId"
            properties:
              PaymentTransactionId:
                $ref: "#/components/schemas/OBPaymentTransactionId"
          RefundPurposeCode:
            $ref: "#/components/schemas/OBPaymentPurposeCode"           
        additionalProperties: false
    OBSingleRefundPayment:
      title: "OBSingleRefundPayment"
      type: "object"
      description: |
        Placeholder for single payment Refund Data.
      required:
        - "Amount"
        - "Date"
        - "PaymentTransactionId"
      properties:            
        Amount:
          $ref: "#/components/schemas/OBActiveCurrencyAmount"
        Date:
          description: |
            Date of the Original Payment
          type: "string"
          format: "date"
        PaymentTransactionId:
          $ref: "#/components/schemas/OBPaymentTransactionId"
      additionalProperties: false
    OBRefundIdResponse:
      title: "OBRefundIdResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "RefundsId"
            - "ConsentId"
            - "Type"
            - "Instruction"
          properties:
            RefundsId:
              $ref: "#/components/schemas/OBRefundId"
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type:
              $ref: "#/components/schemas/OBRefundType"          
            Instruction:
              $ref: "#/components/schemas/OBRefundInitiationInstructionResponse"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Links:
          $ref: "#/components/schemas/OBPaginationRefundLinks"    
        Meta:
          $ref: "#/components/schemas/OBMetaTotalPages"         
    OBMetaTotalPages:
      title: "OBMetaTotalPages"
      description: "Meta Data relevant to the resource"
      type: "object"
      properties:
        TotalPages:
            $ref: "#/components/schemas/OBTotalPages"
      additionalProperties: false
    OBTotalPages:
      title: "OBTotalPages"
      description: "Total number of Pages where a result set is paginated"
      type: "integer"
      format: "int32"
      minimum: 0
    OBRefundId:
      title: "OBRefundId"
      description: "An API specific unique identification as assigned by the PASP to identify the domestic Refund resource."
      type: "string"
      minLength: 1
      maxLength: 40
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    OBRefundInitiationInstructionResponse:
      title: "OBRefundInitiationInstruction"
      description: |
        (Array) of Refund Instructions

        * Please refer to the Business Rules, PIS Limits and Constants, Maximum Refunds per Message for the limit.
      type: "array"
      minItems: 1
      maxItems: 500
      items: 
        required:
          - "RefundStatus"
          - "RefundStatusUpdateDateTime"
          - "Type"
          - "CreationDateTime"
          - "OriginalPayment"
          - "Amount"
        properties:                  
          Amount:
            $ref: "#/components/schemas/OBActiveCurrencyAmount"
          OriginalPayment:
            $ref: "#/components/schemas/OBSingleRefundPayment"
          RefundPurposeCode:
            $ref: "#/components/schemas/OBPaymentPurposeCode"           
          RefundStatus:
            $ref: "#/components/schemas/OBRefundStatus"
          RefundStatusUpdateDateTime:
            $ref: "#/components/schemas/OBStatusUpdateDateTime"
          RefundStatusDetail:
            $ref: "#/components/schemas/OBRefundStatusDetail"                          
          CreationDateTime:
              $ref: "#/components/schemas/OBCreationDateTime"
          Charges:
              $ref: "#/components/schemas/OBCharges"
        additionalProperties: false
    OBRefundStatus:
      title: "OBRefundStatus"
      description: |
        Specifies the status of the Refund information group
        * Pending: Refund initiation or individual transaction included in the Refund initiation is pending. Further checks and status update will be performed.
        * Rejected: The Refund initiation has been rejected
        * AcceptedSettlementCompleted: Settlement of the Debtors account has been completed
        * AcceptedCreditSettlementCompleted: When the Payee account has been credited with the funds of the Refund initiated via the PISP
        * AcceptedWithoutPosting:  When the Recipient Bank has accepted the Refund but has not applied the credit to the Payee account yet.
      type: "string"
      enum:
        - "Pending"
        - "AcceptedSettlementCompleted"
        - "AcceptedCreditSettlementCompleted"
        - "AcceptedWithoutPosting"
        - "Rejected"
      example: Pending
    OBPaginationLinks:
      title: "OBPaginationLinks"
      description: "Links relevant to the resource"
      required:
        - "Self"
        - "Related"
      properties:
        Self:
          $ref: "#/components/schemas/OBRelatedSingleRequestToPay"
        Related:
          $ref: "#/components/schemas/OBRelatedRequestToPayConsent"
        First:
          $ref: "#/components/schemas/OBFirst"
        Prev:
          $ref: "#/components/schemas/OBPrev"
        Next:
          $ref: "#/components/schemas/OBNext"
        Last:
          $ref: "#/components/schemas/OBLast"
      additionalProperties: false
    OBPaginationRefundLinks:
      title: "OBPaginationLinks"
      description: "Links relevant to the resource"
      required:
        - "Self"
        - "Related"
      properties:
        Self:
          $ref: "#/components/schemas/OBRelatedSingleRefund"
        Related:
          $ref: "#/components/schemas/OBRelatedRefundsConsent"
        First:
          $ref: "#/components/schemas/OBFirst"
        Prev:
          $ref: "#/components/schemas/OBPrev"
        Next:
          $ref: "#/components/schemas/OBNext"
        Last:
          $ref: "#/components/schemas/OBLast"
      additionalProperties: false
    OBFirst:
      title: "OBFirst"
      description: "A link to the first page in a paginated result set"
      type: "string"
      format: "uri"
    OBPrev:
      title: "OBPrev"
      description: "A link to the previous page in a paginated result set"
      type: "string"
      format: "uri"
    OBNext:
      title: "OBNext"
      description: "A link to the next page in a paginated result set"
      type: "string"
      format: "uri"
    OBLast:
      title: "OBLast"
      description: "A link to the last page in a paginated result set"
      type: "string"
      format: "uri"
    OBRelatedSingleRefund:
      title: "OBRelatedSingleRefund" 
      type: string
      format: "uri"
      description: "A link to the current refunds resource"
      example: "/refunds/83b47199-90c2-4c05-9ef1-aeae68b0fc7c"        
    OBRelatedSingleRequestToPay:
      title: "OBRelatedSingleRequestToPay" 
      type: string
      format: "uri"
      description: "A link to the current requests to pay resource"
      example: "/requests-to-pay/83b47199-90c2-4c05-9ef1-aeae68b0fc7c"        
    OBRelatedRequestToPayConsent:
      title: "OBRelatedRequestToPayConsent"
      description: "A link to the related requests to pay consents resource"
      type: "string"
      format: "uri"
      example: "/request-to-pay-consents/aac-69255d98-ab0e-4758-92a7-cacbf3073efa"
    OBRelatedRefundsConsent:
      title: "OBRelatedRefundsConsent"
      description: "A link to the related refund consents resource"
      type: "string"
      format: "uri"
      example: "/refund-consents/aac-69255d98-ab0e-4758-92a7-cacbf3073efa"
    OBRefundType:
      type: "string"
      description: |
        The type of Refund being instructed which must match against the Refund Type(s) set under the Consent Schedule
      enum:
        - KSAOB.SingleRefund 
        - KSAOB.LongLivedRefund
    OBSingleRefundConsent:
      title: "OBSingleRefundConsent"
      type: "object"
      description: |
        A single immediate Refund consent that MUST be be used for a Single Refund with the PASP.
      required:
        - "Type"
        - "Instruction"
      properties:            
        Type: 
          type: "string"  
          description: "The Refund Type"
          enum:
          - KSAOB.SingleRefund
        Instruction:
          $ref: "#/components/schemas/OBRefundInitiationInstruction"  
      additionalProperties: false
    OBLongLivedRefundConsent:
      title: "OBLongLivedRefundConsent"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a series of future Refunds occurring at an unspecified schedule AND each Refund is of different amount which is unknown at the point of consent.
      required: 
        - "Type"
        - "Currency"
        - "MaximumIndividualRefundAmount" 
        - "MaximumCumulativeValueOfRefunds"
        - "MaximumCumulativeNumberOfRefunds" 
      properties:
        Type:
          description: |
            The type of Refund
          type: "string"
          enum:
          - KSAOB.LongLivedRefund
        Currency:
          $ref: "#/components/schemas/OBActiveOrHistoricCurrencyCode"
        MaximumIndividualRefundAmount:
          $ref: "#/components/schemas/OBMaximumIndividualRefundAmount"
        MaximumCumulativeNumberOfRefunds:
          $ref: "#/components/schemas/OBMaximumCumulativeNumberOfRefunds"     
        MaximumCumulativeValueOfRefunds:
          $ref: "#/components/schemas/OBMaximumCumulativeValueOfRefunds"
        MaximumRefundPaymentDaysLimit:
          $ref: "#/components/schemas/OBMaximumRefundPaymentDaysLimit"
        PeriodicSchedule:
          $ref: "#/components/schemas/OBAdHocPeriodicRefundsLimit"          
      additionalProperties: false
    OBMaximumCumulativeValueOfRefunds:
      title: "OBMaximumCumulativeValueOfRefunds"
      type: "string"
      description: |
        The maximum cumulative value of all successful Refunds under the Consent. 
        Every successful Refund amount related to the Consent is added to the total cumulative value of the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBMaximumIndividualRefundAmount:
      title: "OBMaximumIndividualRefundAmount"
      description: |
        This is the Maximum amount a variable Refund related to the Consent can take. 
        All Refund amounts must be smaller or equal to this value.   
      type: "string"
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBMaximumRefundPaymentDaysLimit:
      title: "OBMaximumRefundPaymentDaysLimit"
      description: |
        This is the maximum refund payment time limit in Days during which a refund can be initiated.
        
        * Please refer to the Business Rules, PIS Limits and Constants, Max Refunds Allowable Time Window for the limit.
      type: "integer"
      example: 5               
    OBMaximumCumulativeNumberOfRefunds: 
      type: "integer"
      title: "OBMaximumCumulativeNumberOfRefunds"
      description: |
        The maximum cumulative number of all successful Refunds under the Consent. 
        Every sucessful Refund related to the Consent is added to the total cumulative number of Refunds of the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.        
    OBRequestToPayConsentRequest:
      title: "OBRequestToPayConsentRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ControlParameters"
            - "AcceptedAuthorizationType"
          properties:
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationType"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the RequestToPay Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                ConsentSchedule:
                  type: "object"
                  description: |
                    A list of the various Request To Pay types that can be initiated
                  oneOf:
                    - $ref: "#/components/schemas/OBSingleRequestToPayConsent"          
                    - $ref: "#/components/schemas/OBLongLivedRequestToPayConsent"
                  discriminator:
                    propertyName: Type                        
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "CreditorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a Request To Pay."
              properties:
                CreditorAgent:
                  $ref: "#/components/schemas/OBCreditorAgent"
                CreditorAccount:
                  $ref: "#/components/schemas/OBCreditorAccount"
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"     
    OBCreditorAccount:
      title: "OBCreditorAccount"
      description: "Unambiguous identification of the account of the creditor to which a credit entry will be posted."
      type: "object"
      additionalProperties: false
      required:
        - "IdentificationType"
        - "Identification"
        - "Name"
      properties:
        IdentificationType:
          $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
        Identification:
          $ref: "#/components/schemas/OBIdentification"
        Name:
          $ref: "#/components/schemas/OBName"
        TradingName:
          $ref: "#/components/schemas/OBTradingName"
    OBRequestToPayConsentResponse:
      title: "OBRequestToPayConsentResponse"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "ConsentId"
            - "BaseConsentId"
            - "ConsentStatus"
            - "ConsentStatusUpdateDateTime"
            - "Initiation"
            - "CreationDateTime"
            - "ControlParameters"
            - "RequestToPayConsumption"
            - "AcceptedAuthorizationType"
            - "ExpirationDateTime"
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            BaseConsentId:
              $ref: "#/components/schemas/OBBaseConsentId"
            AcceptedAuthorizationType: 
              $ref: "#/components/schemas/OBAcceptedAuthorizationType"
            AuthorizationExpirationTimeWindow:
              $ref: "#/components/schemas/OBAuthorizationExpirationTimeWindow"
            ExpirationDateTime:   
              $ref: "#/components/schemas/OBConsentExpirationDateTime"
            ConsentStatus:
              $ref: "#/components/schemas/OBConsentStatus"
            ConsentFlags:
              $ref: "#/components/schemas/OBConsentFlags"         
            RevokedBy:
               $ref: "#/components/schemas/OBRevokedBy"
            ConsentSuspended:
               $ref: "#/components/schemas/OBConsentSuspended"               
            ConsentStatusUpdateDateTime:
              $ref: "#/components/schemas/OBStatusUpdateDateTime"
            CreationDateTime:
                $ref: "#/components/schemas/OBCreationDateTime"
            ControlParameters:
              description: |
                Control Parameters set the overall rules for the RequestToPay Schedule
              type: "object"
              additionalProperties: false
              required:
                - "ConsentSchedule"
              properties:
                ConsentSchedule:
                  type: "object"
                  description: |
                    A list of the various Request To Pay types that can be initiated
                  oneOf:
                    - $ref: "#/components/schemas/OBSingleRequestToPayConsent"          
                    - $ref: "#/components/schemas/OBLongLivedRequestToPayConsent"
                  discriminator:
                    propertyName: Type                        
            Initiation:
              type: "object"
              additionalProperties: false
              required:
                - "CreditorAccount"
              description: "The Initiation payload is sent by the initiating party to the PASP. It is used to request movement of funds from the debtor account to a creditor for a Request To Pay."
              properties:
                CreditorAgent:
                  $ref: "#/components/schemas/OBCreditorAgent"
                CreditorAccount:
                  $ref: "#/components/schemas/OBCreditorAccount"
            RequestToPayConsumption:
              $ref: "#/components/schemas/OBRequestToPayConsumption"          
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
        Subscription:
          $ref: "#/components/schemas/OBEventNotification"          
        Links:
          $ref: "#/components/schemas/OBLinksRelatedRequestToPay"    
        Meta:
          $ref: "#/components/schemas/OBMetaMultiAuthorization"          
    OBRTPExpiryWindow: 
      title: "OBRTPExpiryWindow"
      type: "string"
      description: |
        Specifies the Requests to Pay Expiration Window.
        The time window is based on a custom time format hhh:mm:ss. e.g. 720:00:00 represents a time window of 720 hours, 00 minutes, 00 seconds (30 days).  
        
        * Please refer to the Business Rules, PIS Limits and Constants, RTP Expiry Window for the limit.

      pattern: '^(00[0-9]|0[1-9][0-9]|[1-6][0-9]{2}|7[01][0-9]|720):[0-5][0-9]:[0-5][0-9]$'
      example: "48:00:00"
    OBLinksRelatedRequestToPay:
      title: "OBLinksRelatedRequestToPay"
      type: "object"
      description: "Links relevant to the resource"
      required:
        - "Self"            
        - "Related"            
      properties:
        Self:
          $ref: "#/components/schemas/OBSelfRequestToPayConsent"
        Related:
          $ref: "#/components/schemas/OBRelatedRequestToPay"
      additionalProperties: false
    OBRelatedRequestToPay:
      title: "OBRelatedRequestToPay" 
      type: "array"      
      description: |  
        A link to the related Requests to Pay resource.

        * This Array will contain entries for all the Requests To Pay resources created against this Consent.        
      items:      
        type: "string"
      example: []        
    OBRequestToPayConsumption:
      title: "OBRequestToPayConsumption"
      type: "object"
      description: |
        Data to track the consumption of RTPs in relation to an authorized Consent Schedule
      required:
      - "CumulativeNumberOfRequestsToPay"
      - "CumulativeValueOfRequestsToPay"
      - "CumulativeValueOfRequestsToPayPerCurrentPeriod"
      properties:
        CumulativeNumberOfRequestsToPay:
          type: "number"
          description: |
            The cumulative number of RTP instructions successfully paid under the current consent schedule (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 4
        CumulativeValueOfRequestsToPay:
          description: |
            The cumulative value of RTP instructions successfully paid under the current consent schedule (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "40.00"              
        CumulativeNumberOfRequestsToPayPerCurrentPeriod:
          type: "number"
          description: |
            The cumulative number of RTP instructions in the current period that are successfully paid (Settlement on the Creditor's account has been completed)
          minLength: 1
          example: 1
        CumulativeValueOfRequestsToPayPerCurrentPeriod:
          description: |
            The cumulative value of RTP instructions in the current period that are successfully paid (Settlement on the Creditor's account has been completed)
            A number of monetary units specified in an active currency where the unit of currency is explicit and compliant with ISO 4217."
          type: "string"
          pattern: "^\\d{1,16}\\.\\d{2}$"
          example: "10.00"                                     
      additionalProperties: false
    OBSingleRequestToPayConsent:
      title: "OBSingleRequestToPayConsent"
      type: "object"
      description: |
        A single Request To Pay consent that MUST be be used for a Single Request To Pay with the PASP.
      required:
        - "Type"
      properties:            
        Type: 
          type: "string"  
          description: "The Request To Pay Type"
          enum:
          - KSAOB.SingleRequestToPay
        Instruction:
          description: |
            (Array) of Single or Multiple Request To Pay Instructions

            * Please refer to the Business Rules, PIS Limits and Constants, Maximum RTPs per Message for the limit.
          type: "array"
          minItems: 1
          maxItems: 10
          items:
            required:
              - "Amount"
              - "DebtorAccount"
              - "RequestToPayPurposeCode"
            properties:              
              Amount:
                $ref: "#/components/schemas/OBActiveCurrencyAmount"     
              DebtorAgent:
                $ref: "#/components/schemas/OBCreditorAgent"
              DebtorAccount:
                $ref: "#/components/schemas/OBDebtorAccount"          
              RequestToPayPurposeCode:
                $ref: "#/components/schemas/OBPaymentPurposeCode"      
              NoteToPayer:
                $ref: "#/components/schemas/OBRTPPayerNote"     
              RequestToPayExpiryWindow:
                $ref: "#/components/schemas/OBRTPExpiryWindow"    
            additionalProperties: false
      additionalProperties: false
    OBLongLivedRequestToPayConsent:
      title: "OBLongLivedRequestToPayConsent"
      type: "object"
      description: |
        A long-lived consent that MUST be used for a series of Request To Pays
      required: 
        - "Type"
        - "MaximumIndividualRequestsToPayAmount"
        - "MaximumCumulativeNumberOfRequestsToPay"
        - "MaximumCumulativeValueOfRequestsToPay"
      properties:
        Type:
          description: |
            The type of Request To Pay
          type: "string"
          enum:
          - KSAOB.LongLivedRequestToPay
        MaximumIndividualRequestsToPayAmount:
          $ref: "#/components/schemas/OBMaximumIndividualRequestsToPayAmount"     
        MaximumCumulativeNumberOfRequestsToPay:
          $ref: "#/components/schemas/OBMaximumCumulativeNumberOfRequestsToPay"     
        MaximumCumulativeValueOfRequestsToPay:
          $ref: "#/components/schemas/OBMaximumCumulativeValueOfRequestsToPay"     
        PeriodicSchedule:
          $ref: "#/components/schemas/OBRequestToPayPeriodicSchedule"
      additionalProperties: false
    OBRequestToPayPeriodicSchedule:
      title: "OBAdHocPeriodicSchedule"
      description: |
        Payment Controls that apply to all reques to pay instructions in a given period under this payment consent. 
      type: "object"
      additionalProperties: false
      required:
        - "PeriodType"
        - "PeriodStartDate"
      properties:
        PeriodType: 
          $ref: "#/components/schemas/OBPeriodType"
        PeriodStartDate:
          $ref: "#/components/schemas/OBPeriodStartDate"
        MaximumCumulativeNumberOfRequestsToPayPerPeriodType:
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeNumberOfRequestsToPay" 
        MaximumCumulativeValueOfRequestsToPayPerPeriodType:
          $ref: "#/components/schemas/OBPeriodTypeMaximumCumulativeValueOfRequestsToPay" 
    OBPeriodTypeMaximumCumulativeNumberOfRequestsToPay: 
      type: "integer"
      description: |
        The maximum frequency of request to pay initiations per Period Type.          
    OBDebtorAccount:
      title: "OBDebtorAccount"
      description: "Unambiguous identification of the account of the debtor to which a debit entry will be made."
      type: "object"
      required:
      - "IdentificationType"
      - "Identification"
      - "Name"
      properties:
        IdentificationType:
          $ref: "#/components/schemas/OBExternalAccountIdentificationCode"
        Identification:
          $ref: "#/components/schemas/OBIdentification"
        Name:
          $ref: "#/components/schemas/OBName"
    OBMaximumIndividualRequestsToPayAmount:
      description: |
        This is the Maximum amount a single request to pay amount related to the Consent can be. 
        All request to pay amounts must be smaller or equal to this value.   
      type: "string"
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"                
    OBMaximumCumulativeNumberOfRequestsToPay: 
      type: "integer"
      description: |
        The maximum cumulative number of all succesful Request To Pays under the Consent. 
        Every successful Request To Pay related to the Consent is added to the total cumulative number of Request To Pay initiations of the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.        
    OBMaximumCumulativeValueOfRequestsToPay:
      type: "string"
      description: |
        The maximum cumulative value of all successfully paid requst to pay instructions under the Consent. 
        Each successfully paid request to pay amount (related to the Consent) is added to the total cumulative value of the Consent which cannot exceed the maximum value agreed with the PSU at the point of consent.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"               
    OBPeriodTypeMaximumCumulativeValueOfRequestsToPay:
      type: "string"
      description: |
        The maximum cumulative request to pay value of all request to pay initiations per Period Type.
      pattern: "^\\d{1,16}\\.\\d{2}$"
      example: "100.00"                
    OBRequestToPayRequest:
      title: "OBRequestToPayRequest"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
      properties:
        Data:
          type: "object"
          required:
            - "ConsentId"
            - "Instruction"
            - "Type"
          properties:
            ConsentId:
              $ref: "#/components/schemas/OBConsentId"
            Type:
              description: |
                The type of Request To Pay
              type: "string"
              enum:
              - KSAOB.LongLivedRequestToPay
            Instruction:
              description: |

                (Array) of Single or Multiple Request To Pay Instructions

                * Please refer to the Business Rules, PIS Limits and Constants, Maximum RTPs per Message for the limit.
              type: "array"
              minItems: 1
              maxItems: 10
              items:
                required:
                  - "Amount"
                  - "DebtorAccount"
                  - "RequestToPayPurposeCode"
                properties:              
                  Amount:
                    $ref: "#/components/schemas/OBActiveCurrencyAmount"     
                  DebtorAgent:
                    $ref: "#/components/schemas/OBCreditorAgent"
                  DebtorAccount:
                    $ref: "#/components/schemas/OBDebtorAccount"                    
                  RequestToPayPurposeCode:
                    $ref: "#/components/schemas/OBPaymentPurposeCode"           
                  NoteToPayer:
                    $ref: "#/components/schemas/OBRTPPayerNote"     
                  RequestToPayExpiryWindow:
                    $ref: "#/components/schemas/OBRTPExpiryWindow"    
                additionalProperties: false
          additionalProperties: false
        Risk:
          $ref: "#/components/schemas/OBRiskPSUIndicators"
    OBRequestToPayTransactionId:
      title: "OBRequestToPayTransactionId"
      type: "string"
      description: |
        The TransactionId associated with a payment generated from the Payment Rails.
      example: "oz2c8wpre1vy34tx7q"
    OBRequestToPayTypeResponse:
      type: "string"
      description: |
        The type of Request To Pay being instructed which must match against the Request To Pay Type(s) set under the Consent Schedule
      enum:
        - KSAOB.SingleRequestToPay 
        - KSAOB.LongLivedRequestToPay
    OBPendingCancellation:
      type: boolean
      description: |
        This boolean flag is only set to True when:
        * The PISP initiates an RTP Cancellation with the PASP
        * The current RTP Status is: Pending
      default: false                   
    OBRequestToPayStatus:
      title: "OBRequestToPayStatus"
      description: |
        Specifies the status of the Request To Pay information group
        * Initiated: The Request To Pay has been received by the Receiving PASP but not delivered to Payer.
        * Pending: The Request To Pay is pending a response from the Payer.
        * Cancelled: The Request To Pay Cancellation request has been accepted by the Receiving PASP.
        * Accepted: The Request To Pay has been accepted by the Payer.
        * Expired:  The Request to Pay has expired due to no action from the Payer.
        * Paid: The Payer has fulfilled and paid the Request To Pay.
        * Rejected: The Payer has rejected the Request To Pay.
        * Failed: The Request to Pay has failed (either from the Originating PASP or Receiving PASP).
        * NotSubmitted: The Sender cancels the Request To Pay before submitting it to the Payer.
      type: "string"
      enum:
        - "Initiated"
        - "Pending"
        - "Cancelled"
        - "Accepted"
        - "Expired"
        - "Paid"
        - "Rejected"
        - "Failed"
        - "NotSubmitted"
      example: Initiated
    OBPatchRequestsToPayIdSigned: 
      title: "OBPatchRequestsToPayIdSigned"
      type: "object"
      additionalProperties: false
      required:
        - "Data"
        - "Links"
        - "Meta"
      properties:
        Data:
          type: "object"
          additionalProperties: false
          required:
            - "Instruction"
          properties:
            Instruction:
              $ref: "#/components/schemas/OBRequestToPayModificationRequest"
    OBRequestToPayModificationRequest:
      title: "OBRequestToPayModificationRequest"
      description: |
        (Array) of Single or Multiple Request To Pay Instructions

        * Please refer to the Business Rules, PIS Limits and Constants, Maximum RTPs per Message for the limit.
      type: "array"
      minItems: 1
      maxItems: 10
      items: 
        allOf:
          - type: "object"
            required:
              - "RequestToPayTransactionId"
              - "Status"
            properties:                  
              RequestToPayTransactionId:
                $ref: "#/components/schemas/OBRequestToPayTransactionId"
              Status:
                $ref: "#/components/schemas/OBRequestToPayModifyStatus"
            additionalProperties: false
    OBRequestToPayModifyStatus:
      title: "OBRequestToPayModifyStatus"
      description: |
        Specifies the status allowed to modify a Request To Pay
        * Cancelled: The Request To Pay initiation has been cancelled
      type: "string"
      enum:
        - "Cancelled"
      example: Cancelled
    OBRevokedBy:
      title: "OBRevokedBy"
      description: |
        Denotes the Identifier of the revocation.
        
        | Identifier| Description|
        |-----------|------------|
        | PASP | Revoked by PASP without PSU initiation|
        | TPP | Revoked by TPP without PSU initiation|
        | PASP.InitiatedByPSU | Initiated by PSU via the PASP|
        | TPP.InitiatedByPSU | Initiated by PSU via the TPP|      
      type: "string"
      enum:
        - "KSAOB.PASP"
        - "KSAOB.TPP"
        - "KSAOB.PASP.InitiatedByPSU"
        - "KSAOB.TPP.InitiatedByPSU"
    OBRevokedByPatchConsent:
      title: "OBRevokedByPatchConsent"
      description: |
        Denotes the Identifier of the revocation.
        
        | Identifier| Description|
        |-----------|------------|
        | TPP | Revoked by TPP without PSU initiation|
        | TPP.InitiatedByPSU | Initiated by PSU via the TPP|      
      type: "string"
      enum:
        - "KSAOB.TPP"
        - "KSAOB.TPP.InitiatedByPSU"
    OBConsentExpirationDateTime:
      description: |
        Specified date and time the consent will expire.
        If this is not populated, the consent will remain active as a long lived consent until the maximum consent validity period as per section 4.1.1 Consent Elements in the API User Guide.
        All dates in the JSON payloads are represented in ISO 8601 date-time format.
        All date-time fields in responses must include the timezone. An example is :2023-04-05T10:43:07+00:00

        * For Payment Consents, the maximum expiration time limit should be 23:59:59 (1 second before 00:00:00)
      type: "string"
      format: "date-time"
    OBAddress:
      title: "OBAddress"
      description: |
        (Array) Address information that locates and identifes a specific address, as defined by a national or international postal service."
      type: "array"
      minItems: 1
      items:
        type: "object"
        required:
          - "AddressType"
          - "Country"
        properties:
          AddressType:
            $ref: "#/components/schemas/OBAddressTypeCode"
          ShortAddress:
            $ref: "#/components/schemas/OBShortAddress"
          UnitNumber:
            $ref: "#/components/schemas/OBUnitNumber"
          FloorNumber:
            $ref: "#/components/schemas/OBFloorNumber"
          BuildingNumber:
            $ref: "#/components/schemas/OBBuildingNumber"
          StreetName:
            $ref: "#/components/schemas/OBStreetName"
          SecondaryNumber:
            $ref: "#/components/schemas/OBSecondaryNumber"
          District:
            $ref: "#/components/schemas/OBDistrict"
          PostalCode:
            $ref: "#/components/schemas/OBPostalCode"
          POBox:
            $ref: "#/components/schemas/OBPOBox"
          ZipCode:
            $ref: "#/components/schemas/OBZipCode"
          City:
            $ref: "#/components/schemas/OBCity"          
          Region:
            $ref: "#/components/schemas/OBRegion"
          Country:
            $ref: "#/components/schemas/OBCountryCode"    
        additionalProperties: false      
    OBAddressTypeCode:
      title: "OBAddressTypeCode"
      description: "Specifies the nature of the Address."
      type: "string"
      enum:
        - "KSAOB.Business"
        - "KSAOB.Correspondence"
        - "KSAOB.Residential"
      example: "KSAOB.Residential"
    OBShortAddress:
      title: "OBShortAddress"
      description: "A short address consists of four letters: region code, branch code, division code, unique code and a four-digit number for the building."
      type: "string"
      minLength: 1
      maxLength: 8
      example: "ABCD1234"
    OBUnitNumber:
      title: "OBUnitNumber"
      description: "Identifies the unit or apartment number."
      type: "string"
      minLength: 1
      maxLength: 10
      example: "6"
    OBFloorNumber:
      title: "OBFloorNumber"
      description: "Identifies the building floor number."
      type: "string"
      minLength: 1
      maxLength: 10
      example: "2"
    OBBuildingNumber:
      title: "OBBuildingNumber"
      description: "Identifies the building number."
      type: "string"
      minLength: 1
      maxLength: 10
      example: "34"
    OBStreetName:
      title: "OBStreetName"
      description: "Identifies the street name or road."
      type: "string"
      minLength: 1
      maxLength: 70
      example: "Omar Bin Hassan Street"
    OBDistrict:
      title: "OBDistrict"
      description: "Identifies the district of a city."
      type: "string"
      minLength: 1
      maxLength: 35
      example: "Olaya Dist."
    OBCountryCode:
      title: "OBCountryCode"
      description: "Indicates the country code in which the address is located (References ISO 3166-1 alpha-2)."
      type: "string"
      pattern: "^[A-Z]{2,2}$"
      example: "SA"
    OBPostalCode:
      title: "OBPostalCode"
      description: " Identifies the postal code; a unique code assigned to a specific geographic area for efficient mail sorting and delivery purposes."
      type: "string"
      minLength: 1
      maxLength: 10                    
      example: "12345"
    OBPOBox:
      title: "POBox"
      description: " Identifies the POBox."
      type: "string"
      minLength: 1
      maxLength: 10                    
      example: "11562"
    OBZipCode:
      title: "ZipCode"
      description: "Identifies the ZIP code; a unique code assigned to a specific geographic area for efficient mail sorting and delivery purposes."
      type: "string"
      minLength: 1
      maxLength: 10                    
      example: "12366"
    OBSecondaryNumber:
      title: "OBSecondaryNumber"
      description: "4 numbers representing the accurate location coordinates of the address"
      type: "string"
      minLength: 4
      maxLength: 4
      example: "1233"
    OBCity:
      title: "OBCity"
      description: "Identifies the name of the city or town where the address is situated."
      type: "string"
      minLength: 1
      maxLength: 35
      example: "Riyadh"
    OBRegion:
      title: "OBRegion"
      description: "Identifies the region."
      type: "string"
      minLength: 1
      maxLength: 35
      example: "North"
    OBPSUIndicators:
      title: "OBPSUIndicators"
      type: "object"
      description: |
        PSU (Payer) Indicators
      properties:          
        PSUName: 
          type: "object"
          description: "The Name of the PSU initiating the Payment"
          properties:
            en:
              type: "string"
              description: "English value of the string"
            ar:
              type: "string"
              description: "Arabic value of the string"              
        GeoLocation: 
          type: "object"
          description: "GPS to identify and track the whereabouts of the connected electronic device."
          required:
            - "latitude"
            - "longitude"
          properties:
            latitude:
              type: "string"
              description: "latitude"
            longitude:
              type: "string"
              description: "longitude"              
        DeviceId: 
          type: "string"
          description: "IMEISV number of the connected electronic device"
        PasswordChangedDateTime: 
          type: "string"
          format: "date-time"
          description: "The date and time of the last password change by the PSU on their TPP account."
        PSUOnboardingDateTime: 
          type: "string"
          format: "date-time"
          description: "The exact date and time when the PSU account was activated with the TPP."      
    OBTransactionIndicators:
      title: "OBTransactionIndicators"
      type: "object"
      description: |
        Transaction Indicators
      properties:
        IsCustomerPresent:
          description: "This field differentiates between automatic and manual payment initiation."
          type: boolean
        IsContractPresent:
          description: "Indicates if the Payee has a contractual relationship with the PISP."
          type: boolean
        Channel:
          description: "Where the payment has been initiated from."
          type: "string"
          enum:
            - "KSAOB.Web"
            - "KSAOB.Mobile"        
    OBBeneficiaryIndicators:
      title: "OBBeneficiaryIndicators"
      type: "object"
      description: |
        Beneficiary Indicators
      properties:
        AccountType:
          $ref: "#/components/schemas/OBExternalAccountTypeCode"
        IsBeneficiaryPrePopulated:
          $ref: "#/components/schemas/OBIsBeneficiaryPrePopulated"
        TradingName:
          $ref: "#/components/schemas/OBTradingName"
        IsVerifiedByPISP:
          $ref: "#/components/schemas/OBIsVerifiedbyPISP"
        AdditionalAccountHolderIdentifiers:
          $ref: "#/components/schemas/OBAdditionalAccountHolderIdentifiers"
        MerchantDetails:
          type: "object"
          description: |
            Details of the Merchant involved in the transaction.
            Merchant Details are specified only for those merchant categories that are generally expected to originate retail financial transactions
          properties:
            MerchantId:
              description: "MerchantId"
              type: "string"
              minLength: 8
              maxLength: 20
            MerchantName:
              description: "Name by which the merchant is known."
              type: "string"
              minLength: 1
              maxLength: 350
            MerchantSICCode:
              description: |
                SIC code stands for standard industrial classification (SIC) code.
                This four digit-number identifies a very specific short descriptor of the type of business a company is engaged in.
                SIC can be obtained from the Chamber of Commerce.
              type: "string"
              minLength: 3
              maxLength: 4
          additionalProperties: false                
    OBExternalAccountTypeCode:
      title: "OBExternalAccountTypeCode"
      description: "Specifies the type of account (Retail or Corporate)."
      type: "string"
      enum:
        - "KSAOB.Retail"
        - "KSAOB.Corporate"
    OBIsBeneficiaryPrePopulated:
      description: "Is Beneficiary populated"
      type: "boolean"    
    OBIsVerifiedbyPISP:
      description: "The PISP has onboarded the Beneficiary"
      type: "boolean"    
    OBAdditionalAccountHolderIdentifiers:
      title: "OBAdditionalAccountHolderIdentifiers"
      type: "array"
      items:
        type: "object"
        description: "Provides the details to identify an account."
        required:
          - "IdentificationType"
          - "Identification"
        properties:
          IdentificationType:
            $ref: "#/components/schemas/OBRiskExternalAccountIdentificationCode"
          Identification:
            $ref: "#/components/schemas/OBIdentification"
          Name:
            $ref: "#/components/schemas/OBName"
        additionalProperties: false
    OBRiskExternalAccountIdentificationCode:
      title: "OBRiskExternalAccountIdentificationCode"
      description: "Name of the identification scheme, in a coded form as published in an external list."
      type: "string"
      enum:
        - "KSAOB.UnifiedCommercialNumber"
        - "KSAOB.NationalID"
        - "KSAOB.IqamaNumber"
        - "KSAOB.PassportNumber"

  ############################################
  # PARAMETERS
  ############################################
  parameters:
    #################################################
    # HEADER PARAMETERS
    #################################################
    authorization:
      in: "header"
      name: "authorization"
      required: true
      description: "An authorization Token as per https://tools.ietf.org/html/rfc6750"
      schema:
        type: "string"
      example: Bearer 12773da5-81c5-45e7-893c-381ca3cecc30
    x-customer-user-agent:
      in: "header"
      name: "x-customer-user-agent"
      description: "Indicates the user-agent that the PSU is using."
      required: false
      schema:
        type: "string"
      example: Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_1 like Mac OS X) AppleWebKit/603.1.30 (KHTML, like Gecko) Version/10.0 Mobile/14E304 Safari/602.1
    x-fapi-customer-ip-address:
      in: "header"
      name: "x-fapi-customer-ip-address"
      required: false
      description: "The PSU's IP address if the PSU is currently logged in with the PISP."
      schema:
        type: "string"
      example: 51.235.115.203
    x-fapi-auth-date:
      in: "header"
      name: "x-fapi-auth-date"
      required: false
      description: "The time when the PSU last logged in with the PISP. \nAll dates in the HTTP headers are represented as RFC 7231 Full Dates. An example is below: \nSun, 10 Sep 2023 19:43:31 UTC"
      schema:
        type: "string"
        pattern: "^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), \\d{2} (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) \\d{4} \\d{2}:\\d{2}:\\d{2} (GMT|UTC)$"
      example: Thu, 26 Jan 2023 16:31:32 UTC
    x-fapi-interaction-id-request:
      in: "header"
      name: "x-fapi-interaction-id"
      required: false
      description: "An RFC4122 UID used as a correlation id."
      schema:
        type: "string"
      example: 49df2c2c-6b80-40ee-96a1-71910a248048
    x-fapi-interaction-id-response:
      in: "header"
      name: "x-fapi-interaction-id"
      required: true
      description: "An RFC4122 UID used as a correlation id."
      schema:
        type: "string"
      example: 49df2c2c-6b80-40ee-96a1-71910a248048
    x-idempotency-key:
      name: "x-idempotency-key"
      in: "header"
      description: "Ensures the PASP processes the resource successfully only once per x-idempotency-key"
      required: true
      schema:
        type: "string"
        maxLength: 40
        pattern: "^(?!\\s)(.*)(\\S)$"
      example: 78dae4513b8847f98e2d4173b4ed0eb6
    x-idempotency-key-consent:
      name: "x-idempotency-key"
      in: "header"
      description: "Ensures the PASP processes the resource successfully only once per x-idempotency-key"
      schema:
        type: "string"
        maxLength: 40
        pattern: "^(?!\\s)(.*)(\\S)$"
      example: 78dae4513b8847f98e2d4173b4ed0eb6
    Location:
      name: "Location"
      in: "header"
      description: "URI location to the created resource"
      required: true
      schema:
        type: "string"
        maxLength: 40      
    Prefer:
      name: "Prefer"
      in: "header"
      description: |
        Preferences that allow certain behaviours on the API. 
        * Request To Pay: CancelAllPendingRequestsToPay=true - Can be used to cancel all Requests to Pay that are in a Pending Status
      required: false
      schema:
        type: "string"
        maxLength: 40      
      example: CancelAllPendingRequestsToPay=true
    Preference-Applied:
      name: "Preference-Applied"
      in: "header"
      description: |
        Determines that the requested Preference was applied by the API
        * Request to Pay: CancelAllPendingRequestsToPay=true - Confirms that all Requests to Pay in a Pending Status were successfully Cancelled. 
      required: false
      schema:
        type: "string"
        maxLength: 40      
      example: CancelAllPendingRequestsToPay=true
    #################################################
    # PATH PARAMETERS
    #################################################
    PaymentId:
      name: "PaymentId"
      in: "path"
      description: "Unique identification as assigned by the PASP to uniquely identify the domestic payment resource."
      schema:
        type: "string"
        minLength: 1
        maxLength: 40
      required: true
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    ConsentId:
      name: "ConsentId"
      in: "path"
      description: "Unique identification as assigned by the PASP to uniquely identify the Consent resource"
      required: true
      schema:
        type: "string"
      example: aac-69255d98-ab0e-4758-92a7-cacbf3073efa
    RefundsId:
      name: "RefundsId"
      in: "path"
      description: "Unique identification as assigned by the PASP to uniquely identify the domestic Refund resource."
      schema:
        type: "string"
        minLength: 1
        maxLength: 40
      required: true
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    RequestsToPayId:
      name: "RequestsToPayId"
      in: "path"
      description: "API specific unique identification as assigned by the PASP to identify the domestic RequestToPay resource."
      schema:
        type: "string"
        minLength: 1
        maxLength: 40
      required: true
      example: 83b47199-90c2-4c05-9ef1-aeae68b0fc7c
    #################################################
    # QUERY PARAMETERS
    #################################################
    paymentTransactionId:
      in: "query"
      name: "paymentTransactionId"
      description: |
        A series of one or more payment rails transactionIds. For example:
        * A single transactionId: 
        ```
        paymentTransactionId=oz2c8wpre1vy34tx7q 
        ```
        * Multiple transactionIds: 
        ```
        paymentTransactionId=oz2c8wpre1vy34tx7q,aa2c8wpre1vy34txbb,cc2c8wpre1vy34txdd 
        ```
      schema:
        type: "array"
        items:
          type: "string"
      style: "form"
      explode: false
      examples:
        singleTransactionId:
          summary: "Example of a single transaction"
          value: ["oz2c8wpre1vy34tx7q"]  
        multiTransactionId:
          summary: "Example of multiple transactions"
          value: ["oz2c8wpre1vy34tx7q","aa2c8wpre1vy34txbb","cc2c8wpre1vy34txdd"]  
      allowEmptyValue: false
    requestToPayTransactionId:
      in: "query"
      name: "requestToPayTransactionId"
      description: |
        A series of one or more payment rails transactionIds. For example:
        * A single transactionId: 
        ```
        requestToPayTransactionId=oz2c8wpre1vy34tx7q 
        ```
        * Multiple transactionIds: 
        ```
        requestToPayTransactionId=oz2c8wpre1vy34tx7q,aa2c8wpre1vy34txbb,cc2c8wpre1vy34txdd 
        ```
      schema:
        type: "array"
        items:
          type: "string"
      style: "form"
      explode: false
      examples:
        singleTransactionId:
          summary: "Example of a single transaction"
          value: ["oz2c8wpre1vy34tx7q"]  
        multiTransactionId:
          summary: "Example of multiple transactions"
          value: ["oz2c8wpre1vy34tx7q","aa2c8wpre1vy34txbb","cc2c8wpre1vy34txdd"]  
      allowEmptyValue: false
    baseConsentId:
      in: "query"
      name: "baseConsentId"
      required: true
      description: |
        A specific baseConsentId. For example:
        ```
        baseConsentId=abc-19877d98-ab0e-4758-92a7-vvffr1234abv 
        ```
      schema:
        type: "string"
      allowEmptyValue: false
      example: abc-19877d98-ab0e-4758-92a7-vvffr1234abv
  #################################################
  # SECURITY SCHEMES
  #################################################
  securitySchemes:
    PISPOAuth2Security:
      type: oauth2
      description: "PISP confidential client authorization with the PASP to stage a consent. **Please refer to [OpenID FAPI Security Profile 1.0 -Part 2 Advanced](https://openid.net/specs/openid-financial-api-part-2-1_0.html#authorization-server) - 5.2.2 point 14 - shall authenticate the confidential client using one of the following methods private_key_jwt and [OpenID Connect Core 1.0](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication) 9. Client Authentication private_key_jwt**"      
      flows:
        clientCredentials:
          tokenUrl: "https://authserver.example/token"
          scopes:
            openid: Activates OpenID Connect Support
            payments: Ability for accessing payments. 
            refunds: Ability for accessing refunds.        
            requeststopay: Ability for accessing requests to pay.   
    PSUOAuth2Security:
      type: oauth2
      description: "[OAuth2 PAR flow](https://datatracker.ietf.org/doc/html/rfc9126), it is required when the PSU needs to perform SCA with the PASP when a TPP wants to access an PASP resource owned by the PSU. **Please refer to [OpenID FAPI Security Profile 1.0 -Part 2 Advanced](https://openid.net/specs/openid-financial-api-part-2-1_0.html#authorization-server) - 5.2.2 point 14 - shall authenticate the confidential client using one of the following methods private_key_jwt and [OpenID Connect Core 1.0](https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication) 9. Client Authentication private_key_jwt**"
      flows:
        authorizationCode:
          authorizationUrl: "https://authserver.example/authorization"
          tokenUrl: "https://authserver.example/token"
          scopes:
            openid: Activates OpenID Connect Support
            "payments:<consentId>": Ability for initiating payments. This is a parameterized scope with the ConsentId
            "refunds:<consentId>": Ability for initiating refunds. This is a parameterized scope with the ConsentId       
            "requeststopay:<consentId>": Ability for initiating requests to pay. This is a parameterized scope with the ConsentId   
    PASPWebhookSecurity:
      type: http
      description: "The PASP generates a Self Signed JWT Authorization Token for Client Authentication with the PISP. **Please refer to Self-Signed JWT Authorization Token Specification in the KSA Standard API User Guide**"
      scheme: bearer
      bearerFormat: JWT
  ############################################
  # EXAMPLES
  ############################################
  examples:  
    Error400BadRequestSigned:
      summary: 400 Bad Request
      description: 400 Bad Request
      value: {"iss":"c50f0152-49bb-4dc4-b866-b625271c4e78","exp":3349494246,"nbf":1675765189,"aud":["e63df191-5fff-4e9c-bba2-b273c94e87f0"],"iat":1675765189,"message":{"Errors":[{"Code":"KSAOB.GenericError","Message":{"en":"A mandatory field is missing."}}]}} 
    Error403ForbiddenSigned:
      summary: 403 Forbidden
      description: 403 Forbidden
      value: {"iss":"c50f0152-49bb-4dc4-b866-b625271c4e78","exp":3349494246,"nbf":1675765189,"aud":["e63df191-5fff-4e9c-bba2-b273c94e87f0"],"iat":1675765189,"message":{"Errors":[{"Code":"KSAOB.AccessToken.InvalidScope","Message":{"en":"The access token did not have an appropriate scope attached to it."}}]}}
    Error500InternalServerErrorSigned:
      summary: 500 Internal Server Error
      description: 500 Internal Server Error
      value: {"iss":"c50f0152-49bb-4dc4-b866-b625271c4e78","exp":3349494246,"nbf":1675765189,"aud":["e63df191-5fff-4e9c-bba2-b273c94e87f0"],"iat":1675765189,"message":{"Errors":[{"Code":"KSAOB.GenericError","Message":{"en":"An Internal Server error has occurred. Please retry in 60 seconds."}}]}}